<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Log on HelloWood</title><link>https://blog.hellowood.dev/tags/log/</link><description>Recent content in Log on HelloWood</description><generator>Hugo</generator><language>cn</language><lastBuildDate>Mon, 01 Jan 0001 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.hellowood.dev/tags/log/index.xml" rel="self" type="application/rss+xml"/><item><title>SpringBoot 使用 ELK 日志收集系统安装配置</title><link>https://blog.hellowood.dev/posts/springboot-%E4%BD%BF%E7%94%A8-elk-%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</link><pubDate>Sun, 21 Jan 2018 21:16:10 +0800</pubDate><guid>https://blog.hellowood.dev/posts/springboot-%E4%BD%BF%E7%94%A8-elk-%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</guid><description>&lt;h2 id="elasticsearch"&gt;Elasticsearch&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;下载 &lt;a href="https://www.elastic.co/cn/downloads/elasticsearch"&gt;Elasticsearch&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;解压并运行 &lt;code&gt;bin/elasticsearch&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;访问 &lt;code&gt;http://localhost:9200&lt;/code&gt;, 会看到以下内容&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;{
 &amp;#34;name&amp;#34; : &amp;#34;9KA6kPN&amp;#34;,
 &amp;#34;cluster_name&amp;#34; : &amp;#34;elasticsearch&amp;#34;,
 &amp;#34;cluster_uuid&amp;#34; : &amp;#34;BtscSPXeR0manhl2LibpuA&amp;#34;,
 &amp;#34;version&amp;#34; : {
 &amp;#34;number&amp;#34; : &amp;#34;6.1.1&amp;#34;,
 &amp;#34;build_hash&amp;#34; : &amp;#34;bd92e7f&amp;#34;,
 &amp;#34;build_date&amp;#34; : &amp;#34;2017-12-17T20:23:25.338Z&amp;#34;,
 &amp;#34;build_snapshot&amp;#34; : false,
 &amp;#34;lucene_version&amp;#34; : &amp;#34;7.1.0&amp;#34;,
 &amp;#34;minimum_wire_compatibility_version&amp;#34; : &amp;#34;5.6.0&amp;#34;,
 &amp;#34;minimum_index_compatibility_version&amp;#34; : &amp;#34;5.0.0&amp;#34;
 },
 &amp;#34;tagline&amp;#34; : &amp;#34;You Know, for Search&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;安装 Head 插件&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;bin/plugin install mobz/elasticsearch-head
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="logstash"&gt;Logstash&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;下载 &lt;a href="https://www.elastic.co/cn/downloads/logstash"&gt;Logstash&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;解压&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;添加配置&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;添加 &lt;code&gt;log_to_es.conf&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;input {
 tcp {
 host =&amp;gt; &amp;#34;localhost&amp;#34;
 port =&amp;gt; 4560
 mode =&amp;gt; &amp;#34;server&amp;#34;
 tags =&amp;gt; [&amp;#34;applog&amp;#34;]
 codec =&amp;gt; json_lines
 }
}
output {
 stdout{codec =&amp;gt;rubydebug}
 elasticsearch {
 action =&amp;gt; &amp;#34;index&amp;#34; #The operation on ES
 hosts =&amp;gt; &amp;#34;localhost:9200&amp;#34; #ElasticSearch host, can be array.
 index =&amp;gt; &amp;#34;applog&amp;#34; #The index to write data to.
 }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这是从本地通过 TCP 读取读取日志并发送到 ElasticSearch&lt;/p&gt;</description></item><item><title>SpringBoot 中日志使用</title><link>https://blog.hellowood.dev/posts/springboot-%E4%B8%AD%E6%97%A5%E5%BF%97%E4%BD%BF%E7%94%A8/</link><pubDate>Fri, 19 Jan 2018 21:23:45 +0800</pubDate><guid>https://blog.hellowood.dev/posts/springboot-%E4%B8%AD%E6%97%A5%E5%BF%97%E4%BD%BF%E7%94%A8/</guid><description>&lt;h2 id="配置日志输出到文件"&gt;配置日志输出到文件&lt;/h2&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# 输出到指定文件
logging.file=./logs/application.log

# 输出到指定目录下（会写入到 spring.log 中）
logging.path=./logs
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当同时存在 &lt;code&gt;logging.path&lt;/code&gt; 和 &lt;code&gt;logging.file&lt;/code&gt; 时 &lt;code&gt;logging.path&lt;/code&gt; 无效&lt;/p&gt;
&lt;h2 id="日志中添加信息"&gt;日志中添加信息&lt;/h2&gt;
&lt;p&gt;向日志中添加自定义信息可以使用 &lt;code&gt;MDC&lt;/code&gt;类来实现&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;配置文件&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;logging.pattern.level=user:%X{user} %5p
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;类：
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;org.apache.log4j.MDC&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;org.jboss.logging.MDC &lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;org.slf4j.MDC&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;MDC.put(&amp;#34;user&amp;#34;, &amp;#34;Hello&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;输出结果&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;2018-01-18 23:55:10.836 user:Hello INFO 7011 --- [nio-8080-exec-1] cn.com.hellowood.log.LogController : log 2
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h2 id="logback-配置"&gt;logback 配置&lt;/h2&gt;
&lt;h3 id="标签属性"&gt;标签属性&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;configuration&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;scan&lt;/code&gt;: 当属性设置为 &lt;code&gt;true&lt;/code&gt; 时， 配置文件如果发生变化会被重新加载，默认为&lt;code&gt;true&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;scanPeriod&lt;/code&gt;: 设置监测配置文件是否修改的时间间隔，默认单位是毫秒，默认时间间隔1分钟&lt;/li&gt;
&lt;li&gt;&lt;code&gt;debug&lt;/code&gt;：当属性设置为&lt;code&gt;true&lt;/code&gt;时，将打印&lt;code&gt;logback&lt;/code&gt;内部的日志信息，默认为 &lt;code&gt;false&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;root&amp;gt;&lt;/code&gt;：用来指定最基础的日志输出级别&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;level&lt;/code&gt;：设置日志打印级别，大小写不敏感，可以是&lt;code&gt;TRACE,DEBUG,INFO,ERROR,ALL,OFF&lt;/code&gt;，默认&lt;code&gt;DEBUG&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;root level=&amp;#34;debug&amp;#34;&amp;gt;
 &amp;lt;appender-ref ref=&amp;#34;console&amp;#34; /&amp;gt;
 &amp;lt;appender-ref ref=&amp;#34;file&amp;#34; /&amp;gt;
&amp;lt;/root&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;contextName&amp;gt;&lt;/code&gt;：上下文名称，默认为&lt;code&gt;default&lt;/code&gt;，用于区分应用程序，一般改为项目名称，可以通过 &lt;code&gt;%contextName&lt;/code&gt; 添加到日志中&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;property&amp;gt;&lt;/code&gt;：用来定义变量值的标签&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;name&lt;/code&gt;：变量的名称&lt;/li&gt;
&lt;li&gt;&lt;code&gt;value&lt;/code&gt;：变量的值&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;定义的变量可以通过&lt;code&gt;${}&lt;/code&gt;使用&lt;/p&gt;</description></item></channel></rss>