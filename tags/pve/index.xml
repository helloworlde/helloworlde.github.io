<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PVE on HelloWood</title><link>https://blog.hellowood.dev/tags/pve/</link><description>Recent content in PVE on HelloWood</description><generator>Hugo</generator><language>cn</language><lastBuildDate>Sat, 06 Sep 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.hellowood.dev/tags/pve/index.xml" rel="self" type="application/rss+xml"/><item><title>PVE 将 OpenWrt 虚拟机迁移至其他实例</title><link>https://blog.hellowood.dev/posts/pve-%E5%B0%86-openwrt-%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%81%E7%A7%BB%E8%87%B3%E5%85%B6%E4%BB%96%E5%AE%9E%E4%BE%8B/</link><pubDate>Tue, 15 Apr 2025 00:00:00 +0000</pubDate><guid>https://blog.hellowood.dev/posts/pve-%E5%B0%86-openwrt-%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%81%E7%A7%BB%E8%87%B3%E5%85%B6%E4%BB%96%E5%AE%9E%E4%BE%8B/</guid><description>&lt;p&gt;因为需要下线维护当前的 PVE 实例，所以新建了一台 PVE 实例，需要把之前的虚拟机迁移到新的 PVE 实例上，但是通过组建集群复制的方式会从当前的 PVE 中删除该实例，并且新的实例是临时性的，组建集群会带来额外的维护成本，因此通过命令行迁移&lt;/p&gt;
&lt;h2 id="备份虚拟机"&gt;备份虚拟机&lt;/h2&gt;
&lt;p&gt;将虚拟机备份到 &lt;code&gt;~/workspace&lt;/code&gt; 目录下&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir ~/workspace
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;以快照方式备份虚拟机&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;vzdump &lt;span style="color:#ae81ff"&gt;122&lt;/span&gt; --dumpdir ~/workspace --mode snapshot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: starting new backup job: vzdump &lt;span style="color:#ae81ff"&gt;122&lt;/span&gt; --dumpdir /root/workspace/ --mode snapshot
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: Starting Backup of VM &lt;span style="color:#ae81ff"&gt;122&lt;/span&gt; &lt;span style="color:#f92672"&gt;(&lt;/span&gt;qemu&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: Backup started at 2025-04-18 09:27:15
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: status &lt;span style="color:#f92672"&gt;=&lt;/span&gt; running
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: VM Name: op
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: include disk &lt;span style="color:#e6db74"&gt;&amp;#39;sata0&amp;#39;&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;local-lvm:vm-122-disk-0&amp;#39;&lt;/span&gt; 20604M
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: backup mode: snapshot
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: ionice priority: &lt;span style="color:#ae81ff"&gt;7&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: creating vzdump archive &lt;span style="color:#e6db74"&gt;&amp;#39;/root/workspace/vzdump-qemu-122-2025_04_18-09_27_17.vma 125&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: started backup task &lt;span style="color:#e6db74"&gt;&amp;#39;843879b9-5054-4a96-98b2-a87994c97539&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: resuming VM again
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: 100% &lt;span style="color:#f92672"&gt;(&lt;/span&gt;20.1 GiB of 20.1 GiB&lt;span style="color:#f92672"&gt;)&lt;/span&gt; in 2s, read: 10.1 GiB/s, write: 169.4 MiB/s
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: backup is sparse: 19.79 GiB &lt;span style="color:#f92672"&gt;(&lt;/span&gt;98%&lt;span style="color:#f92672"&gt;)&lt;/span&gt; total zero data
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: transferred 20.12 GiB in &lt;span style="color:#ae81ff"&gt;2&lt;/span&gt; seconds &lt;span style="color:#f92672"&gt;(&lt;/span&gt;10.1 GiB/s&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: archive file size: 341MB
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: Finished Backup of VM &lt;span style="color:#ae81ff"&gt;122&lt;/span&gt; &lt;span style="color:#f92672"&gt;(&lt;/span&gt;00:00:02&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: Backup finished at 2025-04-18 09:27:57
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;INFO: Backup job finished successfully
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;待备份完成后，会生成一个 .vma 后缀的备份文件&lt;/p&gt;</description></item></channel></rss>