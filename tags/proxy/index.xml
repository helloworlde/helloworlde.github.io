<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Proxy on HelloWood</title><link>https://blog.hellowood.dev/tags/proxy/</link><description>Recent content in Proxy on HelloWood</description><generator>Hugo</generator><language>cn</language><lastBuildDate>Mon, 01 Jan 0001 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.hellowood.dev/tags/proxy/index.xml" rel="self" type="application/rss+xml"/><item><title>Dae 代理软件的配置</title><link>https://blog.hellowood.dev/posts/dae-%E4%BB%A3%E7%90%86%E8%BD%AF%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE/</link><pubDate>Tue, 29 Apr 2025 00:00:00 +0000</pubDate><guid>https://blog.hellowood.dev/posts/dae-%E4%BB%A3%E7%90%86%E8%BD%AF%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE/</guid><description>&lt;h1 id="tbd">TBD&lt;/h1></description></item><item><title>OpenWrt 安装使用 Dae 作为代理</title><link>https://blog.hellowood.dev/posts/openwrt-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8-dae-%E4%BD%9C%E4%B8%BA%E4%BB%A3%E7%90%86/</link><pubDate>Mon, 28 Apr 2025 00:00:00 +0000</pubDate><guid>https://blog.hellowood.dev/posts/openwrt-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8-dae-%E4%BD%9C%E4%B8%BA%E4%BB%A3%E7%90%86/</guid><description>&lt;p>&lt;a href="https://github.com/daeuniverse/dae">Dae&lt;/a> 是一种高性能透明代理解决方案，在 Linux 内核中使用 eBPF 实现了代理能力；支持以域名、源 IP、目的 IP、源端口、目的端口、TCP/UDP、IPv4/IPv6、进程名、MAC 地址等对流量进行分流；相对于其他代理方案，如 Clash 等，Dae 的代理规则相对灵活，直连的性能更好(本机进程，作为网关实际效果差距不大)&lt;/p>
&lt;p>Dae 的出栈协议支持 HTTPS/VMess/VLESS/Shadowsocks/Trojan/Tuic/Juicity/Hysteria2 等&lt;/p>
&lt;p>Dae 和其他的代理软件如 Clash 等相比，在可靠性、稳定性、速度、容灾等方面并没有明显的优势，并且对设备的要求较高，因此并不见得是最佳选择&lt;/p>
&lt;h2 id="安装-openwrt">安装 OpenWrt&lt;/h2>
&lt;p>因为 dae 是基于 eBPF 实现的，所以需要 OpenWrt 内核支持 eBPF，内核版本需要大于 5.17，并且需要开启 eBPF；OpenWrt 官方提供的镜像未开启 eBPF 支持，需要自行编译，或者使用 ImmortalWRT 构建的镜像&lt;/p>
&lt;h3 id="使用-immortalwrt-构建镜像">使用 ImmortalWRT 构建镜像&lt;/h3>
&lt;p>访问 &lt;a href="https://firmware-selector.immortalwrt.org/">https://firmware-selector.immortalwrt.org/&lt;/a>，我是在 x86 机器的 PVE 中使用虚拟机的方式运行 OpenWrt，因此选择 &lt;code>Generic x86/64&lt;/code>，其他平台如 arm 等选择对应的平台即可&lt;/p>
&lt;p>在 Installed Packages 后面追加 eBPF 和 Dae 相关的包：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>kmod-xdp-sockets-diag kmod-veth kmod-sched-core kmod-sched-bpf kmod-nft-bridge dae-geosite dae-geoip dae
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>软件包的作用如下：&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>软件名&lt;/th>
 &lt;th>作用&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;code>kmod-xdp-sockets-diag&lt;/code>&lt;/td>
 &lt;td>提供 XDP 套接字诊断，用于监控与排查基于 XDP 的高性能网络程序&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>kmod-veth&lt;/code>&lt;/td>
 &lt;td>支持成对虚拟以太网设备（veth），常用于容器网络隔离&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>kmod-sched-core&lt;/code>&lt;/td>
 &lt;td>提供 Linux 内核的流量调度核心框架，支撑 QoS 策略&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>kmod-sched-bpf&lt;/code>&lt;/td>
 &lt;td>基于 BPF 的流量调度扩展，支持自定义数据包处理策略&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>kmod-nft-bridge&lt;/code>&lt;/td>
 &lt;td>在桥接接口上集成 nftables 防火墙规则&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>dae-geosite&lt;/code>&lt;/td>
 &lt;td>为 dae 守护进程提供 GeoSite 支持，可按域名或网站分类过滤流量&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>dae-geoip&lt;/code>&lt;/td>
 &lt;td>为 dae 守护进程提供 GeoIP 支持，可按 IP 地理位置过滤或路由流量&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>dae&lt;/code>&lt;/td>
 &lt;td>核心 dae 守护进程，实现后台流量过滤与转发等网络服务&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>完整的包列表如下：&lt;/p></description></item><item><title>OpenWrt 安装使用 OpenClash</title><link>https://blog.hellowood.dev/posts/openwrt-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8-openclash/</link><pubDate>Thu, 25 Aug 2022 11:20:19 +0800</pubDate><guid>https://blog.hellowood.dev/posts/openwrt-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8-openclash/</guid><description>&lt;h2 id="clash-使用方式对比">Clash 使用方式对比&lt;/h2>
&lt;p>OpenClash 是 Clash 的 OpenWrt 客户端；Clash 有多种使用方式，如直接使用客户端，或者以容器或进程的方式运行在服务器上，客户端以代理的方式使用，或者运行在 OpenWrt 中等；因为各种因素影响，不同的使用方式有不同的适用场景：&lt;/p>
&lt;ul>
&lt;li>运行客户端&lt;/li>
&lt;/ul>
&lt;p>客户端直接使用的方式最灵活，调整代理方式或策略比较方便，可以选择性的开启或关闭，会代理设备上支持代理的所有流量；适用于手机，电脑等有客户端支持等设备&lt;/p>
&lt;ul>
&lt;li>代理方式使用&lt;/li>
&lt;/ul>
&lt;p>代理方式适用于没有客户端软件的场景，如命令行，为特定的软件配置代理等；这种方式不够灵活，可按需为特定应用或设备配置&lt;/p>
&lt;ul>
&lt;li>运行在OpenWrt&lt;/li>
&lt;/ul>
&lt;p>运行在 OpenWrt 等主路由或旁路由中，可以透明代理整个局域网内的流量，对于一些无法直接操作的 IoT 设备非常方便；也不需要修改客户端任何配置；缺点是如果不稳定会影响局域网内的所有设备&lt;/p>
&lt;h2 id="安装">安装&lt;/h2>
&lt;p>需要使用 Clash 配置网络，用于访问特定的资源；&lt;a href="https://github.com/vernesong/OpenClash">OpenClash&lt;/a> 是 Openwrt 的 Clash 客户端；&lt;/p>
&lt;ol>
&lt;li>OpenClash 依赖的是 &lt;code>dnsmasq-full&lt;/code>，所以需要移除默认的&lt;code>dnsmasq&lt;/code>，否则会导致 OpenClash 安装失败&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>opkg remove dnsmasq &lt;span style="color:#c7bf54">&amp;amp;&amp;amp;&lt;/span> opkg install dnsmasq-full
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>下载并安装 OpenClash&lt;/li>
&lt;/ol>
&lt;p>可以在 &lt;a href="https://github.com/vernesong/OpenClash">OpenClash&lt;/a> 仓库的 &lt;a href="https://github.com/vernesong/OpenClash/releases">Release&lt;/a> 页面选择对应的版本进行下载&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>wget https://github.com/vernesong/OpenClash/releases/download/v0.45.35-beta/luci-app-openclash_0.45.35-beta_all.ipk -O openclash.ipk
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>opkg update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>opkg install openclash.ipk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>添加 &lt;code>luci-compact&lt;/code> 并重启，否则会提示进入 luci 页面错误&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>opkg install luci luci-base luci-compat
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>reboot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>待重启完成后重新登录控制台，可以在服务菜单中看到 &lt;code>OpenClash&lt;/code>&lt;/p></description></item></channel></rss>