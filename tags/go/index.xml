<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Go on HelloWood</title><link>https://blog.hellowood.dev/tags/go/</link><description>Recent content in Go on HelloWood</description><generator>Hugo</generator><language>cn</language><lastBuildDate>Sat, 06 Sep 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.hellowood.dev/tags/go/index.xml" rel="self" type="application/rss+xml"/><item><title>使用腾讯云的Serverless部署天气应用</title><link>https://blog.hellowood.dev/posts/%E4%BD%BF%E7%94%A8%E8%85%BE%E8%AE%AF%E4%BA%91%E7%9A%84serverless%E9%83%A8%E7%BD%B2%E5%A4%A9%E6%B0%94%E5%BA%94%E7%94%A8/</link><pubDate>Sun, 13 Oct 2019 18:56:40 +0800</pubDate><guid>https://blog.hellowood.dev/posts/%E4%BD%BF%E7%94%A8%E8%85%BE%E8%AE%AF%E4%BA%91%E7%9A%84serverless%E9%83%A8%E7%BD%B2%E5%A4%A9%E6%B0%94%E5%BA%94%E7%94%A8/</guid><description>&lt;blockquote&gt;
&lt;p&gt;使用腾讯云的Serverless服务，部署一个Go编写的天气变化的提醒应用
该应用通过定时查询高德地图的&lt;a href="https://lbs.amap.com/api/webservice/guide/api/weatherinfo"&gt;天气API&lt;/a&gt;，当当前天气或未来几天天气不好时，通过&lt;a href="http://sc.ftqq.com"&gt;Server酱&lt;/a&gt;在微信中进行提醒&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id="构建应用"&gt;构建应用&lt;/h2&gt;
&lt;p&gt;应用使用 go modules开发&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;go.mod&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c1abea"&gt;module&lt;/span&gt; &lt;span style="color:#c1abea"&gt;weather&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;go&lt;/span&gt; &lt;span style="color:#d19a66"&gt;1.12&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c1abea"&gt;require&lt;/span&gt; &lt;span style="color:#c1abea"&gt;github&lt;/span&gt;.&lt;span style="color:#c1abea"&gt;com&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;/&lt;/span&gt;&lt;span style="color:#c1abea"&gt;tencentyun&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;/&lt;/span&gt;&lt;span style="color:#c1abea"&gt;scf&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;-&lt;/span&gt;&lt;span style="color:#c678dd"&gt;go&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;-&lt;/span&gt;&lt;span style="color:#c1abea"&gt;lib&lt;/span&gt; &lt;span style="color:#c1abea"&gt;v0&lt;/span&gt;&lt;span style="color:#d19a66"&gt;.0.0&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;-&lt;/span&gt;&lt;span style="color:#d19a66"&gt;20190817080819&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;-&lt;/span&gt;&lt;span style="color:#d19a66"&gt;4&lt;/span&gt;&lt;span style="color:#c1abea"&gt;a2819cda320&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;main.go&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;package&lt;/span&gt; &lt;span style="color:#c1abea"&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;import&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;log&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;os&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;strconv&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;time&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;fmt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;github.com/tencentyun/scf-go-lib/cloudfunction&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;weather/tool&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;func&lt;/span&gt; &lt;span style="color:#00b1f7"&gt;main&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;cloudfunction&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;Start&lt;/span&gt;(&lt;span style="color:#c1abea"&gt;checkWeather&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;func&lt;/span&gt; &lt;span style="color:#00b1f7"&gt;checkWeather&lt;/span&gt;() (&lt;span style="color:#ef8383"&gt;string&lt;/span&gt;, &lt;span style="color:#ef8383"&gt;error&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#8a93a5;font-style:italic"&gt;// ...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="创建函数"&gt;创建函数&lt;/h2&gt;
&lt;p&gt;在腾讯云的&lt;a href="https://console.cloud.tencent.com/scf/list?rid=8&amp;amp;ns=default"&gt;Serverless服务&lt;/a&gt;中创建新的函数&lt;/p&gt;
&lt;p&gt;

 &lt;img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9oZWxsb3dvb2Rlcy5vc3MtY24tYmVpamluZy5hbGl5dW5jcy5jb20vYmxvZy9xY2xvdWQtc2VydmVybGVzcy8lRTUlODglOUIlRTUlQkIlQkElRTUlODclQkQlRTYlOTUlQjAucG5n?x-oss-process=image/format,png" alt="创建函数" loading="lazy"&gt;
&lt;/p&gt;
&lt;h2 id="添加配置"&gt;添加配置&lt;/h2&gt;
&lt;p&gt;配置共三项：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;高德地图的SecretKey，可以在高德地图的&lt;a href="https://lbs.amap.com/dev/key/app"&gt;控制面板&lt;/a&gt;中添加应用后获取&lt;/li&gt;
&lt;li&gt;Server酱的SecretKey，在发送的URL中可以找到&lt;/li&gt;
&lt;li&gt;城市id，高德地图的城市id，可以在&lt;a href="https://lbs.amap.com/api/webservice/download"&gt;城市编码&lt;/a&gt;中找到&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="添加环境变量"&gt;添加环境变量&lt;/h3&gt;
&lt;p&gt;在函数配置点击编辑，添加环境变量&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;city xxxx
weatherKey xxxx
notifyKey xxxx
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="上传函数"&gt;上传函数&lt;/h2&gt;
&lt;h3 id="本地编译打包"&gt;本地编译打包&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Mac/Linux&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#dcaeea"&gt;GOOS&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;=&lt;/span&gt;linux &lt;span style="color:#dcaeea"&gt;GOARCH&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;=&lt;/span&gt;amd64 go build -o main main.go
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;zip main.zip main
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Win&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ef8383"&gt;set&lt;/span&gt; &lt;span style="color:#dcaeea"&gt;GOOS&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;=&lt;/span&gt;linux
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ef8383"&gt;set&lt;/span&gt; &lt;span style="color:#dcaeea"&gt;GOARCH&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;=&lt;/span&gt;amd64
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;go build -o main main.go
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后将main添加到压缩文件中&lt;/p&gt;</description></item><item><title>Go 调用 Windows 的系统 API，检测是否锁屏</title><link>https://blog.hellowood.dev/posts/go-%E8%B0%83%E7%94%A8-windows-%E7%9A%84%E7%B3%BB%E7%BB%9F-api%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E9%94%81%E5%B1%8F/</link><pubDate>Sun, 15 Sep 2019 21:56:13 +0800</pubDate><guid>https://blog.hellowood.dev/posts/go-%E8%B0%83%E7%94%A8-windows-%E7%9A%84%E7%B3%BB%E7%BB%9F-api%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E9%94%81%E5%B1%8F/</guid><description>&lt;blockquote&gt;
&lt;p&gt;因为应用需要根据当前电脑是否处于活跃状态来执行不同的动作，所以需要获取电脑当前活跃的窗口判断是否处于锁屏
可以通过调用Windows 的库来执行相应的API&lt;/p&gt;&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;import&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#98c379"&gt;&amp;#34;log&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#98c379"&gt;&amp;#34;syscall&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;func&lt;/span&gt; &lt;span style="color:#00b1f7"&gt;main&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#c678dd"&gt;const&lt;/span&gt; &lt;span style="color:#c1abea"&gt;successCallMessage&lt;/span&gt; = &lt;span style="color:#98c379"&gt;&amp;#34;The operation completed successfully.&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#8a93a5;font-style:italic"&gt;// 加载类库&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#c1abea"&gt;user32&lt;/span&gt; = &lt;span style="color:#c1abea"&gt;syscall&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;NewLazyDLL&lt;/span&gt;(&lt;span style="color:#98c379"&gt;&amp;#34;user32.dll&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#8a93a5;font-style:italic"&gt;// 创建新的调用进程&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#c1abea"&gt;getForegroundWindow&lt;/span&gt; = &lt;span style="color:#c1abea"&gt;user32&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;NewProc&lt;/span&gt;(&lt;span style="color:#98c379"&gt;&amp;#34;GetForegroundWindow&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#8a93a5;font-style:italic"&gt;// 调用相应的函数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#c1abea"&gt;activeWindowId&lt;/span&gt;, &lt;span style="color:#c1abea"&gt;_&lt;/span&gt;, &lt;span style="color:#c1abea"&gt;err&lt;/span&gt; &lt;span style="color:#c7bf54"&gt;:=&lt;/span&gt; &lt;span style="color:#c1abea"&gt;getForegroundWindow&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;Call&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#c678dd"&gt;if&lt;/span&gt; &lt;span style="color:#c1abea"&gt;err&lt;/span&gt; &lt;span style="color:#c7bf54"&gt;!=&lt;/span&gt; &lt;span style="color:#b756ff;font-weight:bold"&gt;nil&lt;/span&gt; &lt;span style="color:#c7bf54"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color:#c1abea"&gt;err&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;Error&lt;/span&gt;() &lt;span style="color:#c7bf54"&gt;!=&lt;/span&gt; &lt;span style="color:#c1abea"&gt;successCallMessage&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#c1abea"&gt;log&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;Println&lt;/span&gt;(&lt;span style="color:#c1abea"&gt;err&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#c1abea"&gt;log&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;Println&lt;/span&gt;(&lt;span style="color:#98c379"&gt;&amp;#34;activeWindowId:&amp;#34;&lt;/span&gt;, &lt;span style="color:#c1abea"&gt;activeWindowId&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;当调用成功后时，会返回三个结果，第一个是当前活跃的窗口 ID，当 ID 为 0 时，就说明处于锁屏状态；第三个参数是操作信息，如果成功内容就是&lt;code&gt;The operation completed successfully.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这个函数没有入参，所以直接通过&lt;code&gt;Call()&lt;/code&gt;调用，函数的详细信息可以参考微软提供的API &lt;a href="https://docs.microsoft.com/zh-cn/windows/win32/api/winuser/nf-winuser-getforegroundwindow"&gt;GetForegroundWindow function&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其他的函数调用也是一样，不同的是传入的参数和返回的结果，但调用过程是一样的&lt;/p&gt;
&lt;h4 id="参考文章"&gt;参考文章&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://docs.microsoft.com/zh-cn/windows/win32/api/"&gt;Programming reference for Windows API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.microsoft.com/zh-cn/windows/win32/api/winuser/nf-winuser-getforegroundwindow"&gt;GetForegroundWindow function&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/golang/go/wiki/WindowsDLLs"&gt;WindowsDLLs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Go 开发命令行工具-OSS文件上传</title><link>https://blog.hellowood.dev/posts/go-%E5%BC%80%E5%8F%91%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7-oss%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</link><pubDate>Sun, 08 Sep 2019 18:53:25 +0800</pubDate><guid>https://blog.hellowood.dev/posts/go-%E5%BC%80%E5%8F%91%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7-oss%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</guid><description>&lt;blockquote&gt;
&lt;p&gt;使用 Go 语言开发一个命令行工具，用于向 OSS 文件上传文件
命令行工具有很多框架，选择使用 &lt;a href="https://github.com/spf13/cobra"&gt;Cobra&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id="准备"&gt;准备&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;安装 Cobra&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;go get -u github.com/spf13/cobra/cobra
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="初始化项目"&gt;初始化项目&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;创建项目&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ef8383"&gt;cd&lt;/span&gt; &lt;span style="color:#dcaeea"&gt;$GOPATH&lt;/span&gt;/src
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir oss
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ef8383"&gt;cd&lt;/span&gt; oss
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cobra init --pkg-name oss
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;此时，已经创建了一个 oss 的目录，里面已经包含一个 root 命令&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;├── LICENSE
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;├── cmd
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;│ └── root.go
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;└── main.go
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#d19a66"&gt;1&lt;/span&gt; directory, &lt;span style="color:#d19a66"&gt;3&lt;/span&gt; files
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;运行 &lt;code&gt;go run main.go&lt;/code&gt;查看root 命令&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;go run main.go
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;A longer description that spans multiple lines and likely contains
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;examples and usage of using your application. For example:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Cobra is a CLI library &lt;span style="color:#c678dd"&gt;for&lt;/span&gt; Go that empowers applications.
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;This application is a tool to generate the needed files
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;to quickly create a Cobra application.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;添加 mod&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;添加mod 是为了更方便的管理依赖，module 设置 GitHub 是为了安装方便&lt;/p&gt;</description></item><item><title>Google Cloud Run 部署 Knative Serverless 应用</title><link>https://blog.hellowood.dev/posts/google-cloud-run-%E9%83%A8%E7%BD%B2-knative-serverless-%E5%BA%94%E7%94%A8/</link><pubDate>Wed, 15 May 2019 08:23:26 +0800</pubDate><guid>https://blog.hellowood.dev/posts/google-cloud-run-%E9%83%A8%E7%BD%B2-knative-serverless-%E5%BA%94%E7%94%A8/</guid><description>&lt;blockquote&gt;
&lt;p&gt;Google Cloud Run 是 Google 最近推出的基于容器运行的支持 Serverless 应用的服务，是 Knative 的Google Cloud 托管版本；和其他的 Serverless 如Google Cloud Functions, AWS Lambda 等相比，优点在于完全的基于容器，且不限语言&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id="安装-cloud-sdk"&gt;安装 &lt;a href="https://cloud.google.com/sdk/"&gt;Cloud SDK&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Cloud SDK 是 Google Cloud 的命令行工具，用于访问Google Cloud相关资源&lt;/p&gt;
&lt;p&gt;具体平台的安装方式可以参考 &lt;a href="https://cloud.google.com/sdk/docs/quickstarts"&gt;https://cloud.google.com/sdk/docs/quickstarts&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="创建应用上传镜像"&gt;创建应用，上传镜像&lt;/h2&gt;
&lt;p&gt;以 Go 语言为例，创建一个应用，根据不同的请求返回不同的内容&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;main.go&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;package&lt;/span&gt; &lt;span style="color:#c1abea"&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;import&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;encoding/json&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;fmt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;net/http&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#98c379"&gt;&amp;#34;net/url&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;type&lt;/span&gt; &lt;span style="color:#c1abea"&gt;CustomResponse&lt;/span&gt; &lt;span style="color:#c678dd"&gt;struct&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;Code&lt;/span&gt; &lt;span style="color:#ef8383"&gt;int&lt;/span&gt; &lt;span style="color:#98c379"&gt;`json:&amp;#34;code&amp;#34;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;Message&lt;/span&gt; &lt;span style="color:#ef8383"&gt;string&lt;/span&gt; &lt;span style="color:#98c379"&gt;`json:&amp;#34;message&amp;#34;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;func&lt;/span&gt; &lt;span style="color:#00b1f7"&gt;main&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;fmt&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;Println&lt;/span&gt;(&lt;span style="color:#98c379"&gt;&amp;#34;Server started&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;http&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;HandleFunc&lt;/span&gt;(&lt;span style="color:#98c379"&gt;&amp;#34;/&amp;#34;&lt;/span&gt;, &lt;span style="color:#c1abea"&gt;rootHandler&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;_&lt;/span&gt; = &lt;span style="color:#c1abea"&gt;http&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;ListenAndServe&lt;/span&gt;(&lt;span style="color:#98c379"&gt;&amp;#34;:8080&amp;#34;&lt;/span&gt;, &lt;span style="color:#b756ff;font-weight:bold"&gt;nil&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;func&lt;/span&gt; &lt;span style="color:#00b1f7"&gt;rootHandler&lt;/span&gt;(&lt;span style="color:#c1abea"&gt;w&lt;/span&gt; &lt;span style="color:#c1abea"&gt;http&lt;/span&gt;.&lt;span style="color:#c1abea"&gt;ResponseWriter&lt;/span&gt;, &lt;span style="color:#c1abea"&gt;r&lt;/span&gt; &lt;span style="color:#c7bf54"&gt;*&lt;/span&gt;&lt;span style="color:#c1abea"&gt;http&lt;/span&gt;.&lt;span style="color:#c1abea"&gt;Request&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;fmt&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;Println&lt;/span&gt;(&lt;span style="color:#98c379"&gt;&amp;#34;Start handler request&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;queryForm&lt;/span&gt;, &lt;span style="color:#c1abea"&gt;err&lt;/span&gt; &lt;span style="color:#c7bf54"&gt;:=&lt;/span&gt; &lt;span style="color:#c1abea"&gt;url&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;ParseQuery&lt;/span&gt;(&lt;span style="color:#c1abea"&gt;r&lt;/span&gt;.&lt;span style="color:#c1abea"&gt;URL&lt;/span&gt;.&lt;span style="color:#c1abea"&gt;RawQuery&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;w&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;Header&lt;/span&gt;().&lt;span style="color:#00b1f7"&gt;Set&lt;/span&gt;(&lt;span style="color:#98c379"&gt;&amp;#34;Content-Type&amp;#34;&lt;/span&gt;, &lt;span style="color:#98c379"&gt;&amp;#34;application/json&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;message&lt;/span&gt; &lt;span style="color:#c7bf54"&gt;:=&lt;/span&gt; &lt;span style="color:#98c379"&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c678dd"&gt;if&lt;/span&gt; &lt;span style="color:#c1abea"&gt;err&lt;/span&gt; &lt;span style="color:#c7bf54"&gt;==&lt;/span&gt; &lt;span style="color:#b756ff;font-weight:bold"&gt;nil&lt;/span&gt; &lt;span style="color:#c7bf54"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color:#ef8383"&gt;len&lt;/span&gt;(&lt;span style="color:#c1abea"&gt;queryForm&lt;/span&gt;[&lt;span style="color:#98c379"&gt;&amp;#34;message&amp;#34;&lt;/span&gt;]) &amp;gt; &lt;span style="color:#d19a66"&gt;0&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#c1abea"&gt;message&lt;/span&gt; = &lt;span style="color:#c1abea"&gt;queryForm&lt;/span&gt;[&lt;span style="color:#98c379"&gt;&amp;#34;message&amp;#34;&lt;/span&gt;][&lt;span style="color:#d19a66"&gt;0&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	} &lt;span style="color:#c678dd"&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#c1abea"&gt;message&lt;/span&gt; = &lt;span style="color:#98c379"&gt;&amp;#34;Hello Go Server&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;_&lt;/span&gt; = &lt;span style="color:#c1abea"&gt;json&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;NewEncoder&lt;/span&gt;(&lt;span style="color:#c1abea"&gt;w&lt;/span&gt;).&lt;span style="color:#00b1f7"&gt;Encode&lt;/span&gt;(&lt;span style="color:#c1abea"&gt;CustomResponse&lt;/span&gt;{&lt;span style="color:#d19a66"&gt;200&lt;/span&gt;, &lt;span style="color:#c1abea"&gt;message&lt;/span&gt;})
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#c1abea"&gt;fmt&lt;/span&gt;.&lt;span style="color:#00b1f7"&gt;Println&lt;/span&gt;(&lt;span style="color:#98c379"&gt;&amp;#34;Handler request completed&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Dockerfile&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-dockerfile" data-lang="dockerfile"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;FROM&lt;/span&gt; &lt;span style="color:#98c379"&gt;golang:1.12.3-alpine3.9&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;RUN&lt;/span&gt; mkdir /app
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;ADD&lt;/span&gt; . /app/
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;WORKDIR&lt;/span&gt; &lt;span style="color:#98c379"&gt;/app&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;RUN&lt;/span&gt; &lt;span style="color:#dcaeea"&gt;CGO_ENABLED&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;=&lt;/span&gt;&lt;span style="color:#d19a66"&gt;0&lt;/span&gt; &lt;span style="color:#dcaeea"&gt;GOOS&lt;/span&gt;&lt;span style="color:#c7bf54"&gt;=&lt;/span&gt;linux go build -o main main.go
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;EXPOSE&lt;/span&gt; &lt;span style="color:#98c379"&gt;8080&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c678dd"&gt;CMD&lt;/span&gt; [&lt;span style="color:#63c381"&gt;&amp;#34;/app/main&amp;#34;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;配置 &lt;a href="https://console.cloud.google.com/gcr"&gt;Google Container Registry&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;相关配置可以参考 &lt;a href="https://cloud.google.com/container-registry/docs/pushing-and-pulling"&gt;推送和拉取映像&lt;/a&gt;，需要注意的是需要一个项目 ID，这个 ID 可以在 &lt;a href="https://console.cloud.google.com/home/dashboard"&gt;home/dashboard&lt;/a&gt; 下找到&lt;/p&gt;</description></item></channel></rss>