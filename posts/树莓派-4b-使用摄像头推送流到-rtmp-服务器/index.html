<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>树莓派 4b 使用摄像头推送流到 RTMP 服务器</title><meta charset=utf-8><meta name=description content="Ladder@树莓派 4b 使用摄像头推送流到 RTMP 服务器 使用树莓派 4b，基于 Ubuntu 22.04，将摄像头的监控内容推送到 RTMP 服务器，用于其他服务从 RTMP 获取视频，进行视频分析和事件告警ss 树莓派摄像头使用排线进行连接，通过 ffmpeg 将视频流推送到 SRS 服务器（SRS是一个简单高效的实时视频服务器，支持RTMP/WebRTC/HLS/HTTP-FLV/SRT/GB28181）
树莓派连接摄像头可以参考 树莓派 4b 使用摄像头
安装 ffmpeg apt-get update && apt-get install -y ffmpeg 安装 SRS SRS 使用 Docker Compose 进行部署；用于处理 ffmpeg 推送的视频流
docker-compose.yaml version: '3' services: srs: image: &#34;registry.cn-hangzhou.aliyuncs.com/ossrs/srs:4&#34; restart: unless-stopped container_name: &#34;srs&#34; hostname: srs ports: - &#34;1935:1935&#34; - &#34;1985:1985&#34; - &#34;8080:8080&#34; volumes: - &#34;./data:/srs&#34; 使用 ffmpeg 推送流到 SRS 通过 ffmpeg 将视频内容推送到 SRS"><meta name=author content="HelloWood"><link rel=canonical href=https://blog.hellowood.dev/posts/%E6%A0%91%E8%8E%93%E6%B4%BE-4b-%E4%BD%BF%E7%94%A8%E6%91%84%E5%83%8F%E5%A4%B4%E6%8E%A8%E9%80%81%E6%B5%81%E5%88%B0-rtmp-%E6%9C%8D%E5%8A%A1%E5%99%A8/><meta name=google-site-verification content="G-3MSGPYTHPZ"><link rel=alternate type=application/rss+xml href=https://blog.hellowood.dev/index.xml title=HelloWood><script async src="https://www.googletagmanager.com/gtag/js?id=G-3MSGPYTHPZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3MSGPYTHPZ",{anonymize_ip:!1})}</script><script async defer data-website-id=7a9034de-0ce7-4756-942a-829e6cd22301 src=https://statistics.lab.hellowood.dev/umami.js></script><meta property="og:title" content="树莓派 4b 使用摄像头推送流到 RTMP 服务器"><meta property="og:description" content="树莓派 4b 使用摄像头推送流到 RTMP 服务器 使用树莓派 4b，基于 Ubuntu 22.04，将摄像头的监控内容推送到 RTMP 服务器，用于其他服务从 RTMP 获取视频，进行视频分析和事件告警ss 树莓派摄像头使用排线进行连接，通过 ffmpeg 将视频流推送到 SRS 服务器（SRS是一个简单高效的实时视频服务器，支持RTMP/WebRTC/HLS/HTTP-FLV/SRT/GB28181）
树莓派连接摄像头可以参考 树莓派 4b 使用摄像头
安装 ffmpeg apt-get update && apt-get install -y ffmpeg 安装 SRS SRS 使用 Docker Compose 进行部署；用于处理 ffmpeg 推送的视频流
docker-compose.yaml version: '3' services: srs: image: &#34;registry.cn-hangzhou.aliyuncs.com/ossrs/srs:4&#34; restart: unless-stopped container_name: &#34;srs&#34; hostname: srs ports: - &#34;1935:1935&#34; - &#34;1985:1985&#34; - &#34;8080:8080&#34; volumes: - &#34;./data:/srs&#34; 使用 ffmpeg 推送流到 SRS 通过 ffmpeg 将视频内容推送到 SRS"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.hellowood.dev/posts/%E6%A0%91%E8%8E%93%E6%B4%BE-4b-%E4%BD%BF%E7%94%A8%E6%91%84%E5%83%8F%E5%A4%B4%E6%8E%A8%E9%80%81%E6%B5%81%E5%88%B0-rtmp-%E6%9C%8D%E5%8A%A1%E5%99%A8/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-11T21:36:47+08:00"><meta property="article:modified_time" content="2023-03-11T21:36:47+08:00"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/%E6%A0%91%E8%8E%93%E6%B4%BE-4b-%E4%BD%BF%E7%94%A8-csi-%E6%91%84%E5%83%8F%E5%A4%B4/"><meta name=twitter:card content="summary"><meta name=twitter:title content="树莓派 4b 使用摄像头推送流到 RTMP 服务器"><meta name=twitter:description content="树莓派 4b 使用摄像头推送流到 RTMP 服务器 使用树莓派 4b，基于 Ubuntu 22.04，将摄像头的监控内容推送到 RTMP 服务器，用于其他服务从 RTMP 获取视频，进行视频分析和事件告警ss 树莓派摄像头使用排线进行连接，通过 ffmpeg 将视频流推送到 SRS 服务器（SRS是一个简单高效的实时视频服务器，支持RTMP/WebRTC/HLS/HTTP-FLV/SRT/GB28181）
树莓派连接摄像头可以参考 树莓派 4b 使用摄像头
安装 ffmpeg apt-get update && apt-get install -y ffmpeg 安装 SRS SRS 使用 Docker Compose 进行部署；用于处理 ffmpeg 推送的视频流
docker-compose.yaml version: '3' services: srs: image: &#34;registry.cn-hangzhou.aliyuncs.com/ossrs/srs:4&#34; restart: unless-stopped container_name: &#34;srs&#34; hostname: srs ports: - &#34;1935:1935&#34; - &#34;1985:1985&#34; - &#34;8080:8080&#34; volumes: - &#34;./data:/srs&#34; 使用 ffmpeg 推送流到 SRS 通过 ffmpeg 将视频内容推送到 SRS"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://blog.hellowood.dev/posts/"},{"@type":"ListItem","position":3,"name":"树莓派 4b 使用摄像头推送流到 RTMP 服务器","item":"https://blog.hellowood.dev/posts/%E6%A0%91%E8%8E%93%E6%B4%BE-4b-%E4%BD%BF%E7%94%A8%E6%91%84%E5%83%8F%E5%A4%B4%E6%8E%A8%E9%80%81%E6%B5%81%E5%88%B0-rtmp-%E6%9C%8D%E5%8A%A1%E5%99%A8/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"树莓派 4b 使用摄像头推送流到 RTMP 服务器","name":"树莓派 4b 使用摄像头推送流到 RTMP 服务器","description":"树莓派 4b 使用摄像头推送流到 RTMP 服务器 使用树莓派 4b，基于 Ubuntu 22.04，将摄像头的监控内容推送到 RTMP 服务器，用于其他服务从 RTMP 获取视频，进行视频分析和事件告警ss 树莓派摄像头使用排线进行连接，通过 ffmpeg 将视频流推送到 SRS 服务器（SRS是一个简单高效的实时视频服务器，支持RTMP/WebRTC/HLS/HTTP-FLV/SRT/GB28181）\n树莓派连接摄像头可以参考 树莓派 4b 使用摄像头\n安装 ffmpeg apt-get update \u0026amp;\u0026amp; apt-get install -y ffmpeg 安装 SRS SRS 使用 Docker Compose 进行部署；用于处理 ffmpeg 推送的视频流\ndocker-compose.yaml version: \u0026#39;3\u0026#39; services: srs: image: \u0026#34;registry.cn-hangzhou.aliyuncs.com/ossrs/srs:4\u0026#34; restart: unless-stopped container_name: \u0026#34;srs\u0026#34; hostname: srs ports: - \u0026#34;1935:1935\u0026#34; - \u0026#34;1985:1985\u0026#34; - \u0026#34;8080:8080\u0026#34; volumes: - \u0026#34;./data:/srs\u0026#34; 使用 ffmpeg 推送流到 SRS 通过 ffmpeg 将视频内容推送到 SRS","keywords":["RaspberryPi","HomeLab"],"articleBody":"树莓派 4b 使用摄像头推送流到 RTMP 服务器 使用树莓派 4b，基于 Ubuntu 22.04，将摄像头的监控内容推送到 RTMP 服务器，用于其他服务从 RTMP 获取视频，进行视频分析和事件告警ss 树莓派摄像头使用排线进行连接，通过 ffmpeg 将视频流推送到 SRS 服务器（SRS是一个简单高效的实时视频服务器，支持RTMP/WebRTC/HLS/HTTP-FLV/SRT/GB28181）\n树莓派连接摄像头可以参考 树莓派 4b 使用摄像头\n安装 ffmpeg apt-get update \u0026\u0026 apt-get install -y ffmpeg 安装 SRS SRS 使用 Docker Compose 进行部署；用于处理 ffmpeg 推送的视频流\ndocker-compose.yaml version: '3' services: srs: image: \"registry.cn-hangzhou.aliyuncs.com/ossrs/srs:4\" restart: unless-stopped container_name: \"srs\" hostname: srs ports: - \"1935:1935\" - \"1985:1985\" - \"8080:8080\" volumes: - \"./data:/srs\" 使用 ffmpeg 推送流到 SRS 通过 ffmpeg 将视频内容推送到 SRS\nffmpeg -f v4l2 -input_format mjpeg -video_size 1280x720 -framerate 30 -i /dev/video0 -c:v libx264 -preset veryfast -tune zerolatency -b:v 2M -minrate 2M -maxrate 2M -bufsize 1M -g 60 -an -f flv rtmp://192.168.2.5/live/livestream 其各个参数含义如下：\n-f v4l2：输入设备为 V4L2 （Video for Linux 2）摄像头。 -input_format mjpeg：输入视频格式为 MJPEG。 -video_size 1280x720：设置视频分辨率为 1280x720。 -framerate 30：设置帧率为 30 帧每秒。 -i /dev/video0：指定输入设备为 /dev/video0。 -c:v libx264：选择 H.264 编码器用于视频编码。 -preset veryfast：选用压缩速度优先的预设（veryfast 表示非常快）。 -tune zerolatency：调整编码器以最小化延迟。 -b:v 2M：设置视频编码的目标比特率为 2 Mbps。 -minrate 2M -maxrate 2M -bufsize 1M：设置最小、最大比特率和缓存大小，以确保稳定的视频传输。 -g 60：设置 GOP （Group of Pictures）大小为 60 帧。 -an：不使用音频流。 -f flv：输出格式为 Flash 视频（FLV）。 rtmp://192.168.2.5/live/livestream：指定输出 URL，将视频流推送到 IP 地址为 192.168.2.5 的服务器上，路径为 /live/livestream。 然后访问 http://192.168.2.5:8080/players/srs_player.html?autostart=true\u0026stream=livestream.flv\u0026port=8080\u0026schema=http 查看视频内容\n使用 Docker 容器运行 ffmpeg 也可以通过 Docker 容器的方式运行 ffmpeg，基于 Ubuntu 的镜像安装 ffmpeg 即可\nversion: '3' services: srs: image: \"registry.cn-hangzhou.aliyuncs.com/ossrs/srs:4\" restart: unless-stopped container_name: \"srs\" hostname: srs ports: - \"1935:1935\" - \"1985:1985\" - \"8088:8080\" volumes: - \"./data:/srs\" ffmpeg: image: \"hellowoodes/ffmpeg-rasp\" restart: unless-stopped container_name: \"ffmpeg\" hostname: ffmpeg extra_hosts: - \"host.docker.internal:host-gateway\" command: \u003e sh -c \"ffmpeg -f v4l2 \\ -input_format mjpeg \\ -video_size 1920x1080 \\ -framerate 24 \\ -i /dev/video0 \\ -c:v libx264 \\ -preset veryfast \\ -tune zerolatency \\ -b:v 2M \\ -minrate 2M \\ -maxrate 2M \\ -bufsize 1M \\ -g 60 \\ -an \\ -f flv \\ rtmp://host.docker.internal/live/livestream\" volumes: - /etc/localtime:/etc/localtime:ro devices: - /dev/video0:/dev/video0 ","wordCount":"267","inLanguage":"en","datePublished":"2023-03-11T21:36:47+08:00","dateModified":"2023-03-11T21:36:47+08:00","author":{"@type":"Person","name":"HelloWood"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.hellowood.dev/posts/%E6%A0%91%E8%8E%93%E6%B4%BE-4b-%E4%BD%BF%E7%94%A8%E6%91%84%E5%83%8F%E5%A4%B4%E6%8E%A8%E9%80%81%E6%B5%81%E5%88%B0-rtmp-%E6%9C%8D%E5%8A%A1%E5%99%A8/"},"publisher":{"@type":"Organization","name":"HelloWood","logo":{"@type":"ImageObject","url":"https://blog.hellowood.dev/favicon.ico"}}}</script><link rel=icon href=/images/avatar.png sizes=16x16><link rel=apple-touch-icon href=/images/avatar.png><link rel=manifest href=/images/avatar.png><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.f8020eba33d585b82c30b2a1ceb0d4c4e8e41fb6d8843d07d8ad056da8712972.css integrity="sha256-+AIOujPVhbgsMLKhzrDUxOjkH7bYhD0H2K0FbahxKXI=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.872dfd2cd00064018a833a6e8e77a0fbf8fbac159546f2f205d4dad79a5d8e15.js></script>
<script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/posts>Blog</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://statistics.lab.hellowood.dev/share/r2Llssnu/Blog>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/helloworlde><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>树莓派 4b 使用摄像头推送流到 RTMP 服务器</h1></header><p><small>March 11, 2023&nbsp;· 267 words&nbsp;· 2 min</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#安装-ffmpeg>安装 ffmpeg</a></li><li><a href=#安装-srs>安装 SRS</a></li><li><a href=#使用-ffmpeg-推送流到-srs>使用 ffmpeg 推送流到 SRS</a></li><li><a href=#使用-docker-容器运行-ffmpeg>使用 Docker 容器运行 ffmpeg</a></li></ul></nav></div><section class=blog-content><h1 id=树莓派-4b-使用摄像头推送流到-rtmp-服务器>树莓派 4b 使用摄像头推送流到 RTMP 服务器</h1><p>使用树莓派 4b，基于 Ubuntu 22.04，将摄像头的监控内容推送到 RTMP 服务器，用于其他服务从 RTMP 获取视频，进行视频分析和事件告警ss
树莓派摄像头使用排线进行连接，通过 ffmpeg 将视频流推送到 <a href=https://ossrs.io/lts/zh-cn/docs/v4/doc/introduction>SRS</a> 服务器（SRS是一个简单高效的实时视频服务器，支持RTMP/WebRTC/HLS/HTTP-FLV/SRT/GB28181）</p><p>树莓派连接摄像头可以参考 <a href=https://blog.hellowood.dev>树莓派 4b 使用摄像头</a></p><h2 id=安装-ffmpeg>安装 ffmpeg</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt-get update <span style=color:#f92672>&amp;&amp;</span> apt-get install -y ffmpeg
</span></span></code></pre></div><h2 id=安装-srs>安装 SRS</h2><p>SRS 使用 Docker Compose 进行部署；用于处理 ffmpeg 推送的视频流</p><ul><li>docker-compose.yaml</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>srs</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#e6db74>&#34;registry.cn-hangzhou.aliyuncs.com/ossrs/srs:4&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#e6db74>&#34;srs&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>hostname</span>: <span style=color:#ae81ff>srs</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;1935:1935&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;1985:1985&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;8080:8080&#34;</span>    
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;./data:/srs&#34;</span>
</span></span></code></pre></div><h2 id=使用-ffmpeg-推送流到-srs>使用 ffmpeg 推送流到 SRS</h2><p>通过 ffmpeg 将视频内容推送到 SRS</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ffmpeg -f v4l2 -input_format mjpeg -video_size 1280x720 -framerate <span style=color:#ae81ff>30</span> -i /dev/video0 -c:v libx264 -preset veryfast -tune zerolatency -b:v 2M -minrate 2M -maxrate 2M -bufsize 1M -g <span style=color:#ae81ff>60</span> -an -f flv rtmp://192.168.2.5/live/livestream
</span></span></code></pre></div><p>其各个参数含义如下：</p><ul><li><code>-f v4l2</code>：输入设备为 V4L2 （Video for Linux 2）摄像头。</li><li><code>-input_format mjpeg</code>：输入视频格式为 MJPEG。</li><li><code>-video_size 1280x720</code>：设置视频分辨率为 1280x720。</li><li><code>-framerate 30</code>：设置帧率为 30 帧每秒。</li><li><code>-i /dev/video0</code>：指定输入设备为 /dev/video0。</li><li><code>-c:v libx264</code>：选择 H.264 编码器用于视频编码。</li><li><code>-preset veryfast</code>：选用压缩速度优先的预设（veryfast 表示非常快）。</li><li><code>-tune zerolatency</code>：调整编码器以最小化延迟。</li><li><code>-b:v 2M</code>：设置视频编码的目标比特率为 2 Mbps。</li><li><code>-minrate 2M -maxrate 2M -bufsize 1M</code>：设置最小、最大比特率和缓存大小，以确保稳定的视频传输。</li><li><code>-g 60</code>：设置 GOP （Group of Pictures）大小为 60 帧。</li><li><code>-an</code>：不使用音频流。</li><li><code>-f flv</code>：输出格式为 Flash 视频（FLV）。</li><li><code>rtmp://192.168.2.5/live/livestream</code>：指定输出 URL，将视频流推送到 IP 地址为 192.168.2.5 的服务器上，路径为 /live/livestream。</li></ul><p>然后访问 <a href="http://rasp.local:8088/players/srs_player.html?autostart=true&amp;stream=livestream.flv&amp;port=8080&amp;schema=http">http://192.168.2.5:8080/players/srs_player.html?autostart=true&amp;stream=livestream.flv&amp;port=8080&amp;schema=http</a> 查看视频内容</p><h2 id=使用-docker-容器运行-ffmpeg>使用 Docker 容器运行 ffmpeg</h2><p>也可以通过 Docker 容器的方式运行 ffmpeg，基于 Ubuntu 的镜像安装 ffmpeg 即可</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>version: <span style=color:#e6db74>&#39;3&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>services:
</span></span><span style=display:flex><span>  srs:
</span></span><span style=display:flex><span>    image: <span style=color:#e6db74>&#34;registry.cn-hangzhou.aliyuncs.com/ossrs/srs:4&#34;</span>
</span></span><span style=display:flex><span>    restart: unless-stopped
</span></span><span style=display:flex><span>    container_name: <span style=color:#e6db74>&#34;srs&#34;</span>
</span></span><span style=display:flex><span>    hostname: srs
</span></span><span style=display:flex><span>    ports:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;1935:1935&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;1985:1985&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;8088:8080&#34;</span>    
</span></span><span style=display:flex><span>    volumes:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;./data:/srs&#34;</span>
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>  ffmpeg:
</span></span><span style=display:flex><span>    image: <span style=color:#e6db74>&#34;hellowoodes/ffmpeg-rasp&#34;</span>
</span></span><span style=display:flex><span>    restart: unless-stopped
</span></span><span style=display:flex><span>    container_name: <span style=color:#e6db74>&#34;ffmpeg&#34;</span>
</span></span><span style=display:flex><span>    hostname: ffmpeg
</span></span><span style=display:flex><span>    extra_hosts:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;host.docker.internal:host-gateway&#34;</span>
</span></span><span style=display:flex><span>    command: &gt; 
</span></span><span style=display:flex><span>      sh -c <span style=color:#e6db74>&#34;ffmpeg -f v4l2 \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -input_format mjpeg \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -video_size 1920x1080 \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -framerate 24 \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -i /dev/video0 \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -c:v libx264 \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -preset veryfast \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -tune zerolatency \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -b:v 2M \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -minrate 2M \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -maxrate 2M \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -bufsize 1M \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -g 60 \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -an \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              -f flv \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              rtmp://host.docker.internal/live/livestream&#34;</span>
</span></span><span style=display:flex><span>    volumes:
</span></span><span style=display:flex><span>      - /etc/localtime:/etc/localtime:ro
</span></span><span style=display:flex><span>    devices:
</span></span><span style=display:flex><span>      - /dev/video0:/dev/video0
</span></span></code></pre></div></section><div class=paginator><a class=prev href=https://blog.hellowood.dev/posts/%E6%A0%91%E8%8E%93%E6%B4%BE-4b-%E4%BD%BF%E7%94%A8-csi-%E6%91%84%E5%83%8F%E5%A4%B4/><span>&larr;&nbsp;&nbsp;</span><span>树莓派 4b 使用 CSI 摄像头</span></a>
<a class=next href=https://blog.hellowood.dev/posts/docker-%E5%BC%80%E5%90%AF%E5%A4%96%E9%83%A8-http-%E8%AE%BF%E9%97%AE/><span>Docker 开启外部 HTTP 访问</span><span>&nbsp;&nbsp;&rarr;</span></a></div><div class=related-resources><h3>Related Resources</h3><nav><ul><li><a href=/posts/%E6%A0%91%E8%8E%93%E6%B4%BE-4b-%E4%BD%BF%E7%94%A8-csi-%E6%91%84%E5%83%8F%E5%A4%B4/>树莓派 4b 使用 CSI 摄像头</a></li></ul></nav></div></article></div><footer class=footer><p>&copy; 2023 <a href=https://blog.hellowood.dev>HelloWood</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg></a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>