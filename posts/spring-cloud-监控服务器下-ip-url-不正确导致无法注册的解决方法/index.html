<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Spring Cloud 监控服务器下 IP/URL 不正确导致无法注册的解决方法</title><meta charset=utf-8><meta name=description content="Ladder@ 本项目仅用到了 Spring Cloud，并没有使用 Eureka 在使用 Spring Cloud 对 Spring Boot 应用通过 Spring Admin 进行监控的时候，当 Admin Server 和被监控的应用都在本地启动的时候没有任何问题，但是当部署到 Server 上之后，Client 在注册到 Admin Server 上时 IP 地址不正确，发现是因为 Server 有内网和外网 IP，但是在应用注册的时候用了内网的 IP，Admin Server 访问该内网 IP 失败，所以应用无法注册
因为没有使用 Eureka，所以配置时需要用 Spring Cloud 的配置来处理
使用 Eureka 请参考 http://www.jianshu.com/p/fa1e9c8e4f47
配置 修改配置文件，添加以下内容 spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port} 说明 当没有任何配置的时候，会使用http://bogon:9999/注册 当 Client 加入了spring.boot.admin.client.prefer-ip=true的时候会以所得到的 IP 注册，此时 IP 为内网 IP，如果部署到服务器上将会无法注册 当 Client 配置为spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port}时将会以所配置的地址进行注册 "><meta name=author content="HelloWood"><link rel=canonical href=https://blog.hellowood.dev/posts/spring-cloud-%E7%9B%91%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B-ip-url-%E4%B8%8D%E6%AD%A3%E7%A1%AE%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95%E6%B3%A8%E5%86%8C%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/><meta name=google-site-verification content="G-3MSGPYTHPZ"><link rel=alternate type=application/rss+xml href=https://blog.hellowood.dev/index.xml title=HelloWood><script async src="https://www.googletagmanager.com/gtag/js?id=G-3MSGPYTHPZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3MSGPYTHPZ",{anonymize_ip:!1})}</script><script async defer data-website-id=7a9034de-0ce7-4756-942a-829e6cd22301 src=https://statistics.lab.hellowood.dev/umami.js></script><meta property="og:title" content="Spring Cloud 监控服务器下 IP/URL 不正确导致无法注册的解决方法"><meta property="og:description" content=" 本项目仅用到了 Spring Cloud，并没有使用 Eureka 在使用 Spring Cloud 对 Spring Boot 应用通过 Spring Admin 进行监控的时候，当 Admin Server 和被监控的应用都在本地启动的时候没有任何问题，但是当部署到 Server 上之后，Client 在注册到 Admin Server 上时 IP 地址不正确，发现是因为 Server 有内网和外网 IP，但是在应用注册的时候用了内网的 IP，Admin Server 访问该内网 IP 失败，所以应用无法注册
因为没有使用 Eureka，所以配置时需要用 Spring Cloud 的配置来处理
使用 Eureka 请参考 http://www.jianshu.com/p/fa1e9c8e4f47
配置 修改配置文件，添加以下内容 spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port} 说明 当没有任何配置的时候，会使用http://bogon:9999/注册 当 Client 加入了spring.boot.admin.client.prefer-ip=true的时候会以所得到的 IP 注册，此时 IP 为内网 IP，如果部署到服务器上将会无法注册 当 Client 配置为spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port}时将会以所配置的地址进行注册 "><meta property="og:type" content="article"><meta property="og:url" content="https://blog.hellowood.dev/posts/spring-cloud-%E7%9B%91%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B-ip-url-%E4%B8%8D%E6%AD%A3%E7%A1%AE%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95%E6%B3%A8%E5%86%8C%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-01-01T11:51:23+00:00"><meta property="article:modified_time" content="2018-01-01T11:51:23+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spring Cloud 监控服务器下 IP/URL 不正确导致无法注册的解决方法"><meta name=twitter:description content=" 本项目仅用到了 Spring Cloud，并没有使用 Eureka 在使用 Spring Cloud 对 Spring Boot 应用通过 Spring Admin 进行监控的时候，当 Admin Server 和被监控的应用都在本地启动的时候没有任何问题，但是当部署到 Server 上之后，Client 在注册到 Admin Server 上时 IP 地址不正确，发现是因为 Server 有内网和外网 IP，但是在应用注册的时候用了内网的 IP，Admin Server 访问该内网 IP 失败，所以应用无法注册
因为没有使用 Eureka，所以配置时需要用 Spring Cloud 的配置来处理
使用 Eureka 请参考 http://www.jianshu.com/p/fa1e9c8e4f47
配置 修改配置文件，添加以下内容 spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port} 说明 当没有任何配置的时候，会使用http://bogon:9999/注册 当 Client 加入了spring.boot.admin.client.prefer-ip=true的时候会以所得到的 IP 注册，此时 IP 为内网 IP，如果部署到服务器上将会无法注册 当 Client 配置为spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port}时将会以所配置的地址进行注册 "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://blog.hellowood.dev/posts/"},{"@type":"ListItem","position":3,"name":"Spring Cloud 监控服务器下 IP/URL 不正确导致无法注册的解决方法","item":"https://blog.hellowood.dev/posts/spring-cloud-%E7%9B%91%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B-ip-url-%E4%B8%8D%E6%AD%A3%E7%A1%AE%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95%E6%B3%A8%E5%86%8C%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spring Cloud 监控服务器下 IP/URL 不正确导致无法注册的解决方法","name":"Spring Cloud 监控服务器下 IP\/URL 不正确导致无法注册的解决方法","description":" 本项目仅用到了 Spring Cloud，并没有使用 Eureka 在使用 Spring Cloud 对 Spring Boot 应用通过 Spring Admin 进行监控的时候，当 Admin Server 和被监控的应用都在本地启动的时候没有任何问题，但是当部署到 Server 上之后，Client 在注册到 Admin Server 上时 IP 地址不正确，发现是因为 Server 有内网和外网 IP，但是在应用注册的时候用了内网的 IP，Admin Server 访问该内网 IP 失败，所以应用无法注册\n因为没有使用 Eureka，所以配置时需要用 Spring Cloud 的配置来处理\n使用 Eureka 请参考 http://www.jianshu.com/p/fa1e9c8e4f47\n配置 修改配置文件，添加以下内容 spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port} 说明 当没有任何配置的时候，会使用http://bogon:9999/注册 当 Client 加入了spring.boot.admin.client.prefer-ip=true的时候会以所得到的 IP 注册，此时 IP 为内网 IP，如果部署到服务器上将会无法注册 当 Client 配置为spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port}时将会以所配置的地址进行注册 ","keywords":["Java","SpringBoot","SpringCloud","Actuator","Issue"],"articleBody":" 本项目仅用到了 Spring Cloud，并没有使用 Eureka 在使用 Spring Cloud 对 Spring Boot 应用通过 Spring Admin 进行监控的时候，当 Admin Server 和被监控的应用都在本地启动的时候没有任何问题，但是当部署到 Server 上之后，Client 在注册到 Admin Server 上时 IP 地址不正确，发现是因为 Server 有内网和外网 IP，但是在应用注册的时候用了内网的 IP，Admin Server 访问该内网 IP 失败，所以应用无法注册\n因为没有使用 Eureka，所以配置时需要用 Spring Cloud 的配置来处理\n使用 Eureka 请参考 http://www.jianshu.com/p/fa1e9c8e4f47\n配置 修改配置文件，添加以下内容 spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port} 说明 当没有任何配置的时候，会使用http://bogon:9999/注册 当 Client 加入了spring.boot.admin.client.prefer-ip=true的时候会以所得到的 IP 注册，此时 IP 为内网 IP，如果部署到服务器上将会无法注册 当 Client 配置为spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port}时将会以所配置的地址进行注册 ","wordCount":"58","inLanguage":"en","datePublished":"2018-01-01T11:51:23Z","dateModified":"2018-01-01T11:51:23Z","author":{"@type":"Person","name":"HelloWood"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.hellowood.dev/posts/spring-cloud-%E7%9B%91%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B-ip-url-%E4%B8%8D%E6%AD%A3%E7%A1%AE%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95%E6%B3%A8%E5%86%8C%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"},"publisher":{"@type":"Organization","name":"HelloWood","logo":{"@type":"ImageObject","url":"https://blog.hellowood.dev/favicon.ico"}}}</script><link rel=icon href=/images/avatar.png sizes=16x16><link rel=apple-touch-icon href=/images/avatar.png><link rel=manifest href=/images/avatar.png><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.f8020eba33d585b82c30b2a1ceb0d4c4e8e41fb6d8843d07d8ad056da8712972.css integrity="sha256-+AIOujPVhbgsMLKhzrDUxOjkH7bYhD0H2K0FbahxKXI=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.872dfd2cd00064018a833a6e8e77a0fbf8fbac159546f2f205d4dad79a5d8e15.js></script>
<script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/posts>Blog</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://statistics.lab.hellowood.dev/share/r2Llssnu/Blog>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/helloworlde><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>Spring Cloud 监控服务器下 IP/URL 不正确导致无法注册的解决方法</h1></header><p><small>January 1, 2018&nbsp;· 58 words&nbsp;· One minute</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#本项目仅用到了-spring-cloud并没有使用-eureka>本项目仅用到了 Spring Cloud，并没有使用 Eureka</a></li><li><a href=#配置>配置</a></li><li><a href=#说明>说明</a></li></ul></nav></div><section class=blog-content><blockquote><h2 id=本项目仅用到了-spring-cloud并没有使用-eureka>本项目仅用到了 Spring Cloud，并没有使用 Eureka</h2></blockquote><blockquote><p>在使用 Spring Cloud 对 Spring Boot 应用通过 Spring Admin 进行监控的时候，当 Admin Server 和被监控的应用都在本地启动的时候没有任何问题，但是当部署到 Server 上之后，Client 在注册到 Admin Server 上时 IP 地址不正确，发现是因为 Server 有内网和外网 IP，但是在应用注册的时候用了内网的 IP，Admin Server 访问该内网 IP 失败，所以应用无法注册</p></blockquote><blockquote><p>因为没有使用 Eureka，所以配置时需要用 Spring Cloud 的配置来处理</p></blockquote><blockquote><p>使用 Eureka 请参考 <a href=http://www.jianshu.com/p/fa1e9c8e4f47>http://www.jianshu.com/p/fa1e9c8e4f47</a></p></blockquote><h2 id=配置>配置</h2><ul><li>修改配置文件，添加以下内容</li></ul><pre tabindex=0><code>spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port}
</code></pre><hr><h2 id=说明>说明</h2><ul><li>当没有任何配置的时候，会使用<code>http://bogon:9999/</code>注册</li><li>当 Client 加入了<code>spring.boot.admin.client.prefer-ip=true</code>的时候会以所得到的 IP 注册，此时 IP 为内网 IP，如果部署到服务器上将会无法注册</li><li>当 Client 配置为<code>spring.boot.admin.client.service-base-url=http://${your_ip}:${your_port}</code>时将会以所配置的地址进行注册</li></ul></section><div class=paginator><a class=prev href=https://blog.hellowood.dev/posts/spring-controller-%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92%E4%B8%AD%E6%B3%A8%E8%A7%A3%E7%9A%84%E4%BD%BF%E7%94%A8/><span>&larr;&nbsp;&nbsp;</span><span>Spring Controller 数据传递中注解的使用</span></a>
<a class=next href=https://blog.hellowood.dev/posts/spring-mvc%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%E5%9B%BD%E9%99%85%E5%8C%96-%E5%A4%9A%E8%AF%AD%E8%A8%80/><span>Spring MVC简单实现国际化/多语言</span><span>&nbsp;&nbsp;&rarr;</span></a></div></article></div><footer class=footer><p>&copy; 2023 <a href=https://blog.hellowood.dev>HelloWood</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg></a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>