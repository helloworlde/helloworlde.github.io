<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>使用 GoLinks 短链接服务简化网址访问</title>
<meta name=description content="最近在内网查找文档时看到一个类似 go/文档名 的链接，在浏览器的 URL 输入后可以跳转到对应的文档，对比其他的短链接服务要方便不少；
一番探索后发现原来是一个叫 GoLinks 的短链接服务，通过域名配合 DNS 搜索域，实现了可以直接访问 go 域名；然后根据路径，重定向到对应的 URL。
什么是 GoLinks …"><meta name=keywords content='blog,hugo,Tools'><meta property="og:url" content="https://blog.hellowood.dev/posts/%E4%BD%BF%E7%94%A8golinks%E7%9F%AD%E9%93%BE%E6%8E%A5%E6%9C%8D%E5%8A%A1%E7%AE%80%E5%8C%96%E7%BD%91%E5%9D%80%E8%AE%BF%E9%97%AE/"><meta property="og:type" content="website"><meta property="og:title" content="使用 GoLinks 短链接服务简化网址访问"><meta property="og:description" content="最近在内网查找文档时看到一个类似 go/文档名 的链接，在浏览器的 URL 输入后可以跳转到对应的文档，对比其他的短链接服务要方便不少；
一番探索后发现原来是一个叫 GoLinks 的短链接服务，通过域名配合 DNS 搜索域，实现了可以直接访问 go 域名；然后根据路径，重定向到对应的 URL。
什么是 GoLinks …"><meta property="og:image" content="https://blog.hellowood.dev/images/avatar.webp"><meta property="og:image:secure_url" content="https://blog.hellowood.dev/images/avatar.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="使用 GoLinks 短链接服务简化网址访问"><meta name=twitter:description content="最近在内网查找文档时看到一个类似 go/文档名 的链接，在浏览器的 URL 输入后可以跳转到对应的文档，对比其他的短链接服务要方便不少；
一番探索后发现原来是一个叫 GoLinks 的短链接服务，通过域名配合 DNS 搜索域，实现了可以直接访问 go 域名；然后根据路径，重定向到对应的 URL。
什么是 GoLinks …"><meta property="twitter:domain" content="https://blog.hellowood.dev/posts/%E4%BD%BF%E7%94%A8golinks%E7%9F%AD%E9%93%BE%E6%8E%A5%E6%9C%8D%E5%8A%A1%E7%AE%80%E5%8C%96%E7%BD%91%E5%9D%80%E8%AE%BF%E9%97%AE/"><meta property="twitter:url" content="https://blog.hellowood.dev/posts/%E4%BD%BF%E7%94%A8golinks%E7%9F%AD%E9%93%BE%E6%8E%A5%E6%9C%8D%E5%8A%A1%E7%AE%80%E5%8C%96%E7%BD%91%E5%9D%80%E8%AE%BF%E9%97%AE/"><meta name=twitter:image content="https://blog.hellowood.dev/images/avatar.webp"><link rel=canonical href=https://blog.hellowood.dev/posts/%E4%BD%BF%E7%94%A8golinks%E7%9F%AD%E9%93%BE%E6%8E%A5%E6%9C%8D%E5%8A%A1%E7%AE%80%E5%8C%96%E7%BD%91%E5%9D%80%E8%AE%BF%E9%97%AE/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.9a920d7dabdbad8363b6a0a94e29a9dfebdb7ee64cfcb193a0145e512ef2bdab.js integrity="sha256-mpINfavbrYNjtqCpTimp3+vbfuZM/LGToBReUS7yvas="></script><script defer src=https://umami.hellowood.dev/script.js data-website-id=7a9034de-0ce7-4756-942a-829e6cd22301></script><script defer src=https://cloud.umami.is/script.js data-website-id=73ff1c8c-9938-43cf-81af-e77e26b0cca3></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "b2e481d136dc428c8c96c8673e2a04cf"}'></script><meta name=google-adsense-account content="ca-pub-3401351766168985"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3401351766168985" crossorigin=anonymous></script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","jtbhx98g62")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-3MSGPYTHPZ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3MSGPYTHPZ")</script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.hellowood.dev/><img src=/images/avatar.webp alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.hellowood.dev/>HelloWood</a></div><div class=nav-links><div class=nav-link><a href=https://blog.hellowood.dev/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://blog.hellowood.dev/posts/><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://blog.hellowood.dev/tags/><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://github.com/helloworlde><span data-feather=github></span></a></div><div class=nav-link><a href=https://umami.hellowood.dev/share/lab/Blog><span data-feather=pie-chart></span></a></div><div class=nav-link><a href=https://blog.hellowood.dev/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target"></span>
<a><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.hellowood.dev/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://blog.hellowood.dev/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://blog.hellowood.dev/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://github.com/helloworlde><span data-feather=github></span></a></li><li class=nav-item><a href=https://umami.hellowood.dev/share/lab/Blog><span data-feather=pie-chart></span></a></li><li class=nav-item><a href=https://blog.hellowood.dev/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>使用 GoLinks 短链接服务简化网址访问</h1><small role=doc-subtitle></small><p class=post-date>2023-11-11</p><ul class=post-tags><li class=post-tag><a href=https://blog.hellowood.dev/tags/tools>Tools</a></li></ul></div><div class=post-content><p>最近在内网查找文档时看到一个类似 <code>go/文档名</code> 的链接，在浏览器的 URL 输入后可以跳转到对应的文档，对比其他的短链接服务要方便不少；</p><p>一番探索后发现原来是一个叫 GoLinks 的短链接服务，通过域名配合 DNS 搜索域，实现了可以直接访问 <code>go</code> 域名；然后根据路径，重定向到对应的 URL。</p><p><img src=https://img.hellowood.dev/picture/go-links-homepage.png alt=go-links-homepage.png></p><h2 id=什么是-golinks>什么是 GoLinks</h2><p>根据 Tailscale 的文档，GoLinks 服务第一次出现应该是2006年，在谷歌作为内部短链接工具，后来被各个公司复制</p><p>GoLinks 通过 DNS 配置，简化了短链接服务本身的访问地址，因此，可以通过形如 <code>go/google</code>, <code>go/search/golinks</code> 这样的方式直接访问</p><p>在 GitHub上搜索发现 Tailscale 也提供了这样的工具，项目地址为 <a href=https://github.com/tailscale/golink>https://github.com/tailscale/golink</a>，在开启 Tailscale 后可以通过 MagicDNS 直接使用。同时可以配置为开发模式，通过内网的 DNS 和搜索域的配合也可以实现相同的功能。相关文档参考 <a href=https://tailscale.com/blog/golink/>Private go links for your tailnet</a></p><h2 id=内网使用-golinks-服务>内网使用 GoLinks 服务</h2><p>使用 GoLinks 服务有两个条件：</p><ol><li>需要能够将 <code>go</code> 解析为对应的服务地址，可以通过配置 DNS 或者 host 的方式实现</li><li>需要 GoLinks 服务监听 80 端口因为访问时为了简单不想再输入 https 或者端口号，因此需要使用 80 端口作为 GoLinks 服务的端口</li></ol><p>有三种方式可以解析 <code>go</code>：</p><ol><li>配置 DNS，将 <code>go</code> 直接解析为 GoLinks 服务的地址</li><li>DNS 服务器配置 <code>go.xxx</code>解析规则，然后通过路由器下发 DNS 搜索域；这样在访问<code>go</code>时就会自动搜索<code>go.xxx</code>域名，适用于内网访问</li><li>修改 host 配置，将 <code>go</code> 指向 GoLinks 服务的地址，适用于不方便配置 DNS 的场景使用</li></ol><h2 id=启动-golinks-服务>启动 GoLinks 服务</h2><p>可以通过 Docker 容器启动 GoLinks 服务，用于快速使用，为了方便测试，将端口指定为 80</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -it --rm -p 80:80 ghcr.io/tailscale/golink:main -dev-listen :80
</span></span></code></pre></div><p>也可以通过 Docker Compose 启动，<code>--sqlitedb /data/golink.db</code>用于指定保存短链接配置的数据库地址</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#e06c75>version</span>: <span style=color:#63c381>&#34;3&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#e06c75>golink</span>:
</span></span><span style=display:flex><span>    <span style=color:#e06c75>image</span>: <span style=color:#98c379>ghcr.io/tailscale/golink:main</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>hostname</span>: <span style=color:#98c379>golink</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>container_name</span>: <span style=color:#98c379>golink</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>command</span>: -<span style=color:#98c379>dev-listen :80 --sqlitedb /data/golink.db</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>restart</span>: <span style=color:#98c379>always</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#63c381>&#34;80:80&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#98c379>./data:/data</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#98c379>TZ=Asia/Shanghai</span>
</span></span></code></pre></div><h2 id=配置网络>配置网络</h2><h3 id=通过-host-配置>通过 host 配置</h3><p>最简单的方式就是配置 host，在 host 中指定 GoLinks 服务的 IP 即可</p><ul><li><code>/etc/hosts</code></li></ul><p>在 host 中添加 <code>go</code>，指向本地</p><pre tabindex=0><code>127.0.0.1       localhost
127.0.0.1       go
</code></pre><p>这样，访问 <code>go/xxx</code> 就会自动跳转到对应的地址，如果没有找到，会跳转到 GoLinks 页面进行配置</p><h3 id=通过-dns-配置>通过 DNS 配置</h3><h4 id=配置-dns-解析>配置 DNS 解析</h4><p>配置 DNS 的方式需要 DNS 服务器支持，在 DNS 中添加对应的解析，以 CoreDNS 为例，添加名为 <code>go.svc.local</code> 的解析，指向部署了 GoLinks 服务的机器</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go.svc.local. IN A 192.168.2.4
</span></span></code></pre></div><p>检查 DNS 解析</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nslookup go.svc.local 192.168.2.2
</span></span><span style=display:flex><span>Server:		192.168.2.2
</span></span><span style=display:flex><span>Address:	192.168.2.2#53
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name:	go.svc.local
</span></span><span style=display:flex><span>Address: 192.168.2.4
</span></span></code></pre></div><h4 id=配置-dns-搜索域>配置 DNS 搜索域</h4><blockquote><p>搜索域包含了一组默认的域名后缀，在 DNS 查询中，当查询一个不完整的域名时，系统会尝试在搜索列表中的每个域名后缀下进行解析，直到找到匹配的域名为止；</p></blockquote><p>如 DNS 为 <code>go.svc.local</code>，配置搜索域为 <code>svc.local</code>，通过 <code>go</code> 访问；查询时会先查找 <code>go</code> 域名，查找不到时会将搜索域添加到域名中进行搜索，即向 DNS 服务器查询 <code>go.svc.local</code></p><h5 id=修改路由器的搜索域>修改路由器的搜索域</h5><p>OpenWrt 路由器默认的搜索域为 <code>lan</code>，其他大部分的路由器默认不会下发搜索域，因此需要手动配置，需要修改为 GoLinks 所在的域（如果图方便可以将 GoLinks 的域名配置为 <code>go.lan</code>）</p><p>OpenWrt 或基于 OpenWrt 的路由器都是使用 Dnsmasq 做 DNS 解析，因此，修改 Dnsmasq 的配置即可</p><ul><li>在页面配置</li></ul><p>将 Local Domain 配置由 <code>lan</code> 修改为 <code>svc.local</code></p><p><img src=https://img.hellowood.dev/picture/go-links-search-lan-configuration-in-openwrt-page.png alt=go-links-search-lan-configuration-in-openwrt-page.png></p><ul><li>修改 <code>/etc/config/dhcp</code></li></ul><p>如果是小米路由器等基于 OpenWrt 修改的路由器，可以登陆后将 dhcp 配置文件的 <code>domain</code> 配置由 <code>lan</code> 修改为 <code>svc.local</code></p><pre tabindex=0><code>config dnsmasq
	option local &#39;/lan/&#39;
	option domain &#39;svc.local&#39;
	// ...
</code></pre><p>这样，重启路由器后再次分配的 DNS 信息中就包含 <code>svc.local</code> 搜索域了</p><p><img src=https://img.hellowood.dev/picture/go-links-search-lan-configuration-by-router.png alt=go-links-search-lan-configuration-by-router.png></p><h5 id=修改设备的搜索域>修改设备的搜索域</h5><p>可以通过网络中的 DNS 配置，手动添加 DNS 搜索域
<img src=https://img.hellowood.dev/picture/go-links-search-lan-configuration.png alt=go-links-search-lan-configuration.png></p><p>也可以在 <code>/etc/resolv.conf</code> 配置中指定 <code>search</code></p><pre tabindex=0><code>search svc.local
nameserver 192.168.2.2
nameserver 223.5.5.5
</code></pre><h2 id=使用>使用</h2><p>在 GoLinks 服务配置 <code>search</code> 路径，指向 <code>https://www.google.com/{{if .Path}}search?q={{QueryEscape .Path}}{{end}}</code>，用于 Google 搜索</p><p>直接访问，会发现跳转到了 <a href=https://www.google.com/>https://www.google.com/</a></p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -i go/search
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#d19a66>302</span> Found
</span></span><span style=display:flex><span>Location: https://www.google.com/
</span></span><span style=display:flex><span>type: post
</span></span><span style=display:flex><span>date: Mon, <span style=color:#d19a66>27</span> Nov <span style=color:#d19a66>2023</span> 03:22:19 GMT
</span></span><span style=display:flex><span>Content-Length: <span style=color:#d19a66>0</span>
</span></span></code></pre></div><p>带上 path 作为查询参数，会发现跳转到了 <a href="https://www.google.com/search?q=%E4%BB%80%E4%B9%88%E6%98%AFgolinks">https://www.google.com/search?q=%E4%BB%80%E4%B9%88%E6%98%AFgolinks</a></p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -i go/search/什么是golinks
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#d19a66>302</span> Found
</span></span><span style=display:flex><span>Location: https://www.google.com/search?q<span style=color:#c7bf54>=</span>%E4%BB%80%E4%B9%88%E6%98%AFgolinks
</span></span><span style=display:flex><span>type: post
</span></span><span style=display:flex><span>date: Mon, <span style=color:#d19a66>27</span> Nov <span style=color:#d19a66>2023</span> 03:34:36 GMT
</span></span><span style=display:flex><span>Content-Length: <span style=color:#d19a66>0</span>
</span></span></code></pre></div></div><div class=prev-next></div><svg id="btt-button" class="arrow-logo" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script><div id=comments><script src=https://utteranc.es/client.js repo=helloworlde/helloworlde.github.io issue-term=title theme=github-light crossorigin=anonymous async></script></div></div></main><footer class=footer><span>&copy; 2024 hellowood.dev</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>