<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Frigate 使用 Hailo 8 或 Hailo 8L 进行对象识别</title>
<meta charset=utf-8><meta name=description content="Ladder@Frigate 使用 Hailo8L 加速 Hailo8/Hailo-8L 是一家以色列的边缘人工智能公司发布的边缘加速器，定位和 Google Coral TPU 完全一致；Hailo-8 算力为 26 TOPS，Hailo-8L 算力为 13 TOPS
特性 Google Coral TPU Hailo8 Hailo8L 支持框架 TensorFlow, TensorFlow Lite TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX 支持模型 MobileNet, Inception, EfficientNet 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 模型功能 对象识别、对象分类，语义分割，姿态识别，音频分类 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 硬件性能 4 TOPS 26 TOPS 13 TOPS 发布时间 2019年 2021年 2023年 功耗 0."><meta name=author content="HelloWood"><link rel=canonical href=https://blog.hellowood.dev/posts/frigate-%E4%BD%BF%E7%94%A8-hailo-8-%E6%88%96-hailo-8l-%E8%BF%9B%E8%A1%8C%E5%AF%B9%E8%B1%A1%E8%AF%86%E5%88%AB/><meta name=google-site-verification content="G-3MSGPYTHPZ"><link rel=alternate type=application/rss+xml href=https://blog.hellowood.dev//index.xml title=HelloWood><script async src="https://www.googletagmanager.com/gtag/js?id=G-3MSGPYTHPZ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3MSGPYTHPZ")}</script><script async defer data-website-id=7a9034de-0ce7-4756-942a-829e6cd22301 src=https://umami.hellowood.dev/script.js></script><script defer data-cf-beacon='{"token": "b2e481d136dc428c8c96c8673e2a04cf"}' src=https://static.cloudflareinsights.com/beacon.min.js></script><meta property="og:url" content="https://blog.hellowood.dev/posts/frigate-%E4%BD%BF%E7%94%A8-hailo-8-%E6%88%96-hailo-8l-%E8%BF%9B%E8%A1%8C%E5%AF%B9%E8%B1%A1%E8%AF%86%E5%88%AB/"><meta property="og:site_name" content="HelloWood"><meta property="og:title" content="Frigate 使用 Hailo 8 或 Hailo 8L 进行对象识别"><meta property="og:description" content="Frigate 使用 Hailo8L 加速 Hailo8/Hailo-8L 是一家以色列的边缘人工智能公司发布的边缘加速器，定位和 Google Coral TPU 完全一致；Hailo-8 算力为 26 TOPS，Hailo-8L 算力为 13 TOPS
特性 Google Coral TPU Hailo8 Hailo8L 支持框架 TensorFlow, TensorFlow Lite TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX 支持模型 MobileNet, Inception, EfficientNet 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 模型功能 对象识别、对象分类，语义分割，姿态识别，音频分类 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 硬件性能 4 TOPS 26 TOPS 13 TOPS 发布时间 2019年 2021年 2023年 功耗 0."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-01T11:25:24+08:00"><meta property="article:modified_time" content="2024-09-01T11:25:24+08:00"><meta property="article:tag" content="NVR"><meta property="article:tag" content="HomeLab"><meta property="article:tag" content="Frigate"><meta property="article:tag" content="Hailo"><meta property="article:tag" content="TPU"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/%E5%9F%BA%E4%BA%8E-frigate-%E4%BD%BF%E7%94%A8-double-take-%E5%92%8C-deepstack-%E5%AF%B9%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E8%BF%9B%E8%A1%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/%E5%9F%BA%E4%BA%8E-frigate-%E4%BD%BF%E7%94%A8-double-take-%E5%92%8C-deepstack-%E5%AF%B9%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E8%BF%9B%E8%A1%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/%E4%BD%BF%E7%94%A8%E5%AE%B6%E5%BA%AD%E5%AE%BD%E5%B8%A6%E5%85%AC%E7%BD%91-ipv6-%E8%87%AA%E5%BB%BA-tailscale-%E7%9A%84-derp-%E8%8A%82%E7%82%B9/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/ubuntu-22-%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/proxmox-ve-%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84-lxc-%E5%AE%B9%E5%99%A8-ct-%E6%A8%A1%E6%9D%BF/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/%E5%9C%A8%E9%BB%91%E7%BE%A4%E6%99%96%E4%BD%BF%E7%94%A8-docker-%E9%83%A8%E7%BD%B2-proxmox-backup-server/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/%E4%BD%BF%E7%94%A8%E9%98%BF%E5%B0%94%E5%8D%A1%E7%89%B9%E7%8C%AB%E6%A3%92%E6%9B%BF%E6%8D%A2%E5%8C%97%E4%BA%AC%E7%A7%BB%E5%8A%A8-gpon-%E5%85%89%E7%8C%AB/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/%E5%9F%BA%E4%BA%8E-frigate-%E4%BD%BF%E7%94%A8-double-take-%E5%92%8C-deepstack-%E5%AF%B9%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E8%BF%9B%E8%A1%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/ubuntu22-%E5%AE%89%E8%A3%85%E5%88%9D%E5%A7%8B%E5%8C%96-hailo-8%E7%B3%BB%E5%88%97-tpu-%E5%8A%A0%E9%80%9F%E5%99%A8/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/ubuntu22-%E5%AE%89%E8%A3%85%E5%88%9D%E5%A7%8B%E5%8C%96-hailo-8%E7%B3%BB%E5%88%97-tpu-%E5%8A%A0%E9%80%9F%E5%99%A8/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Frigate 使用 Hailo 8 或 Hailo 8L 进行对象识别"><meta name=twitter:description content="Frigate 使用 Hailo8L 加速 Hailo8/Hailo-8L 是一家以色列的边缘人工智能公司发布的边缘加速器，定位和 Google Coral TPU 完全一致；Hailo-8 算力为 26 TOPS，Hailo-8L 算力为 13 TOPS
特性 Google Coral TPU Hailo8 Hailo8L 支持框架 TensorFlow, TensorFlow Lite TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX 支持模型 MobileNet, Inception, EfficientNet 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 模型功能 对象识别、对象分类，语义分割，姿态识别，音频分类 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 硬件性能 4 TOPS 26 TOPS 13 TOPS 发布时间 2019年 2021年 2023年 功耗 0."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.hellowood.dev/posts/"},{"@type":"ListItem","position":2,"name":"Frigate 使用 Hailo 8 或 Hailo 8L 进行对象识别","item":"https://blog.hellowood.dev/posts/frigate-%E4%BD%BF%E7%94%A8-hailo-8-%E6%88%96-hailo-8l-%E8%BF%9B%E8%A1%8C%E5%AF%B9%E8%B1%A1%E8%AF%86%E5%88%AB/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Frigate 使用 Hailo 8 或 Hailo 8L 进行对象识别","name":"Frigate 使用 Hailo 8 或 Hailo 8L 进行对象识别","description":"Frigate 使用 Hailo8L 加速 Hailo8/Hailo-8L 是一家以色列的边缘人工智能公司发布的边缘加速器，定位和 Google Coral TPU 完全一致；Hailo-8 算力为 26 TOPS，Hailo-8L 算力为 13 TOPS\n特性 Google Coral TPU Hailo8 Hailo8L 支持框架 TensorFlow, TensorFlow Lite TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX 支持模型 MobileNet, Inception, EfficientNet 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 模型功能 对象识别、对象分类，语义分割，姿态识别，音频分类 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 硬件性能 4 TOPS 26 TOPS 13 TOPS 发布时间 2019年 2021年 2023年 功耗 0.","keywords":["NVR","HomeLab","Frigate","Hailo","TPU"],"articleBody":"Frigate 使用 Hailo8L 加速 Hailo8/Hailo-8L 是一家以色列的边缘人工智能公司发布的边缘加速器，定位和 Google Coral TPU 完全一致；Hailo-8 算力为 26 TOPS，Hailo-8L 算力为 13 TOPS\n特性 Google Coral TPU Hailo8 Hailo8L 支持框架 TensorFlow, TensorFlow Lite TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX 支持模型 MobileNet, Inception, EfficientNet 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等 模型功能 对象识别、对象分类，语义分割，姿态识别，音频分类 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等 硬件性能 4 TOPS 26 TOPS 13 TOPS 发布时间 2019年 2021年 2023年 功耗 0.5-2 W 2.5-4.6 W 1.8-3.2 W 每W性能 8 TOPS/W 10.4 TOPS/W 7.2 TOPS/W 当前价格 约300~1000¥ 约 1300¥ 约550¥ 支持的操作系统 Linux, Windows, MacOS Linux, Windows Linux, Windows 可扩展性 不支持多芯片 支持多芯片并行处理 支持多芯片并行处理 应用领域 物联网设备、嵌入式系统 工业自动化、智能监控、自动驾驶 工业自动化、智能监控、智能零售 Frigate 的最新的代码已经合并了 Hailo8L 的 PR，预计将会在 0.15 版本中正式发布，PR 参考 Initial support for Hailo-8L 和 Hailo amd64 support；虽然 PR 中支持的设备是 Hailo-8L，但是经过测试验证，只需要替换对应的模型，Hailo-8 也是可以正常运行的（Hailo-8 和 Hailo-8L 的模型不能互相使用）\nFrigate 使用 Hailo8/8L 使用之前，需要确保 Hailo 的 PCIE Driver 已经正确安装，参考 Ubuntu22 安装初始化 Hailo 8系列 TPU 加速器\n将 Hailo 设备挂载到容器 docker-compose.yaml 注意，ghcr.io/helloworlde/frigate:0.15-f4d311c-h8l 是基于 4.18 版本的驱动的，而 Frigate 的仓库是基于 4.17 版本的驱动，如果驱动和容器中的运行环境版本不一致，可能会导致 Hailo 调用失败；最新的镜像版本可以在 Packages 中查找\nservices: frigate-hailo: container_name: frigate-hailo privileged: true restart: unless-stopped image: ghcr.io/helloworlde/frigate:0.15-f4d311c-h8l shm_size: 512mb devices: - /dev/hailo0:/dev/hailo0 volumes: - /etc/localtime:/etc/localtime:ro - ./config/:/config - ./data/db/:/data/db - ./data/storage:/media/frigate - type: tmpfs target: /tmp/cache tmpfs: size: 1000000000 ports: - 5000:5000 environment: - TZ=Asia/Shanghai 修改配置文件 配置文件路径是 ./config/config.yml；指定了 detector 使用 hailo8l，并且指定了模型的路径；如果该路径下没有模型，会自动从 S3 下载；默认使用的是 ssd_mobilenet_v1 模型\ndatabase: path: /data/db/frigate.db cameras: bedroom: ffmpeg: inputs: - path: rtsp://admin:123456@192.168.31.100:554/stream1\u0026channel=1 roles: - record - detect objects: track: - person - cat detectors: hailo8l: type: hailo8l device: PCIe model: path: /config/model_cache/h8l_cache/ssd_mobilenet_v1.hef model: width: 300 height: 300 input_tensor: nhwc input_pixel_format: bgr model_type: ssd 如果使用的是 Hailo-8，则需要下载 Hailo-8 的模型到本地挂载到容器中，并修改配置为模型对应的配置；Hailo-8 的模型可以从 Public Pre-Trained Models 下载，以 yolov8n 为例，修改 path、width 和 height 即可\ndetectors: hailo8l: type: hailo8l device: PCIe model: path: /config/model_cache/h8_cache/yolov8n.hef model: width: 640 height: 640 input_tensor: nhwc input_pixel_format: bgr 使用 12个 1080p 的监控，以 5fps 进行视频内容识别，使用 hailo-8 和 yolox 模型的推理速度约为 60ms，使用 hailo-8/8L 和 ssd_mobilenet_v1 模型的推理速度约为 15ms，而 Google Coral TPU 的推理速度约为 8ms；在当前的 Frigate 版本下，使用 Google Coral TPU 和小模型检测对象更快\n遇到的问题 Invalid general ioctl code 0x400c6705 使用官方的镜像启动后包错，提示 hailo_platform.pyhailort._pyhailort.HailoRTStatusException，检查 dmesg 发现错误信息为 Invalid general ioctl code 0x400c6705，这是因为驱动版本不一致导致的；官方镜像中的版本为 4.17，而本地安装的驱动版本为 4.18，导致命令无法识别；重新安装 4.17 版本的驱动，或者将 Frigate 镜像中的 HailoRT 版本改为相同的即可\nfrigate 日志：\nfrigate-hailo | 2024-08-24 21:51:44.835191724 [2024-08-24 21:51:44] frigate.detectors.plugins.hailo8l ERROR : HailoRTException during initialization: PCIe driver failure. run 'dmesg | grep hailo' for more information frigate-hailo | 2024-08-24 21:51:44.836911083 Traceback (most recent call last): frigate-hailo | 2024-08-24 21:51:44.836918597 File \"/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py\", line 2610, in _open_vdevice frigate-hailo | 2024-08-24 21:51:44.836919078 self._vdevice = _pyhailort.VDevice.create(self._params, device_ids) frigate-hailo | 2024-08-24 21:51:44.836928015 hailo_platform.pyhailort._pyhailort.HailoRTStatusException: 36 frigate-hailo | 2024-08-24 21:51:44.837285278 frigate-hailo | 2024-08-24 21:51:44.837286139 The above exception was the direct cause of the following exception: frigate-hailo | 2024-08-24 21:51:44.837286440 frigate-hailo | 2024-08-24 21:51:44.837286760 Traceback (most recent call last): frigate-hailo | 2024-08-24 21:51:44.837302350 File \"/usr/lib/python3.9/multiprocessing/process.py\", line 315, in _bootstrap frigate-hailo | 2024-08-24 21:51:44.837302841 self.run() frigate-hailo | 2024-08-24 21:51:44.837308171 File \"/usr/lib/python3.9/multiprocessing/process.py\", line 108, in run frigate-hailo | 2024-08-24 21:51:44.837308732 self._target(*self._args, **self._kwargs) frigate-hailo | 2024-08-24 21:51:44.837309313 File \"/opt/frigate/frigate/object_detection.py\", line 102, in run_detector frigate-hailo | 2024-08-24 21:51:44.837309904 object_detector = LocalObjectDetector(detector_config=detector_config) frigate-hailo | 2024-08-24 21:51:44.837318260 File \"/opt/frigate/frigate/object_detection.py\", line 53, in __init__ frigate-hailo | 2024-08-24 21:51:44.837318961 self.detect_api = create_detector(detector_config) frigate-hailo | 2024-08-24 21:51:44.837319482 File \"/opt/frigate/frigate/detectors/__init__.py\", line 18, in create_detector frigate-hailo | 2024-08-24 21:51:44.837319943 return api(detector_config) frigate-hailo | 2024-08-24 21:51:44.837320514 File \"/opt/frigate/frigate/detectors/plugins/hailo8l.py\", line 73, in __init__ frigate-hailo | 2024-08-24 21:51:44.837322888 self.target = VDevice() frigate-hailo | 2024-08-24 21:51:44.837328058 File \"/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py\", line 2603, in __init__ frigate-hailo | 2024-08-24 21:51:44.837328599 self._open_vdevice() frigate-hailo | 2024-08-24 21:51:44.837329281 File \"/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py\", line 2610, in _open_vdevice frigate-hailo | 2024-08-24 21:51:44.837329902 self._vdevice = _pyhailort.VDevice.create(self._params, device_ids) frigate-hailo | 2024-08-24 21:51:44.837330623 File \"/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py\", line 111, in __exit__ frigate-hailo | 2024-08-24 21:51:44.837331394 self._raise_indicative_status_exception(value) frigate-hailo | 2024-08-24 21:51:44.837338017 File \"/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py\", line 146, in _raise_indicative_status_exception frigate-hailo | 2024-08-24 21:51:44.837338959 raise HailoRTPCIeDriverException(\"PCIe driver failure. run 'dmesg | grep hailo' for more information\") from libhailort_exception frigate-hailo | 2024-08-24 21:51:44.837357273 hailo_platform.pyhailort.pyhailort.HailoRTPCIeDriverException: PCIe driver failure. run 'dmesg | grep hailo' for more information 查看 dmesg 日志：\ndmesg | grep hailo [ 67.062136] hailo_pci: loading out-of-tree module taints kernel. [ 67.062191] hailo_pci: module verification failed: signature and/or required key missing - tainting kernel [ 67.068815] hailo: Init module. driver version 4.18.0 [ 67.069665] hailo 0000:04:00.0: Probing on: 1e60:2864... [ 67.069670] hailo 0000:04:00.0: Probing: Allocate memory for device extension, 11632 ... [ 188.404620] hailo 0000:04:00.0: Invalid general ioctl code 0x400c6705 (nr: 5) 修改为相同版本镜像后 Hailo 成功加载:\nfrigate-hailo | 2024-08-24 22:02:33.745564255 [2024-08-24 22:02:33] frigate.detectors.plugins.hailo8l INFO : A model file already exists at /config/model_cache/h8l_cache/ssd_mobilenet_v1.hef not downloading one. frigate-hailo | 2024-08-24 22:02:33.871380296 [2024-08-24 22:02:33] frigate.detectors.plugins.hailo8l INFO : Hailo device initialized successfully 参考文档 HAILO8L 对象识别模型 HAILO8 对象识别模型 修改 Frigate HailoRT 版本为 4.18 HailoRTPCIeDriverException: PCIe driver failure ","wordCount":"727","inLanguage":"en","datePublished":"2024-09-01T11:25:24+08:00","dateModified":"2024-09-01T11:25:24+08:00","author":{"@type":"Person","name":"HelloWood"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.hellowood.dev/posts/frigate-%E4%BD%BF%E7%94%A8-hailo-8-%E6%88%96-hailo-8l-%E8%BF%9B%E8%A1%8C%E5%AF%B9%E8%B1%A1%E8%AF%86%E5%88%AB/"},"publisher":{"@type":"Organization","name":"HelloWood","logo":{"@type":"ImageObject","url":"https://blog.hellowood.dev/favicon.ico"}}}</script><link rel=icon href=/images/avatar.png sizes=16x16><link rel=apple-touch-icon href=/images/avatar.png><link rel=manifest href=/images/avatar.png><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.7f82854fa0e999ec07c4835d3029de9f484030e254b80d470b3ca48eb934720e.css integrity="sha256-f4KFT6DpmewHxINdMCnen0hAMOJUuA1HCzykjrk0cg4=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><meta name=google-adsense-account content="ca-pub-3401351766168985"><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","jtbhx98g62")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3401351766168985" crossorigin=anonymous></script><script defer src=https://analytics.us.umami.is/script.js data-website-id=73ff1c8c-9938-43cf-81af-e77e26b0cca3></script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand data-umami-event=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link data-umami-event=Blog href=/posts>Blog</a></li><li class="navigation-item navigation-menu"><a class=navigation-link data-umami-event=Tags href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link data-umami-event=Archive href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link data-umami-event=Dashboard href=https://umami.hellowood.dev/share/lab/Blog>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link data-umami-event=navigation-social href=https://github.com/helloworlde><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button data-umami-event=toggle-theme aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>Frigate 使用 Hailo 8 或 Hailo 8L 进行对象识别</h1></header><p><small>September 1, 2024&nbsp;· 727 words&nbsp;· 4 min</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#frigate-使用-hailo88l>Frigate 使用 Hailo8/8L</a><ul><li><a href=#将-hailo-设备挂载到容器>将 Hailo 设备挂载到容器</a></li><li><a href=#修改配置文件>修改配置文件</a></li></ul></li><li><a href=#遇到的问题>遇到的问题</a><ul><li><a href=#invalid-general-ioctl-code-0x400c6705>Invalid general ioctl code 0x400c6705</a></li></ul></li><li><a href=#参考文档>参考文档</a></li></ul></nav></div><section class=blog-content><h1 id=frigate-使用-hailo8l-加速>Frigate 使用 Hailo8L 加速</h1><p>Hailo8/Hailo-8L 是一家以色列的边缘人工智能公司发布的边缘加速器，定位和 <a href=https://coral.ai/products/>Google Coral TPU</a> 完全一致；Hailo-8 算力为 26 TOPS，Hailo-8L 算力为 13 TOPS</p><table><thead><tr><th>特性</th><th>Google Coral TPU</th><th>Hailo8</th><th>Hailo8L</th></tr></thead><tbody><tr><td><strong>支持框架</strong></td><td>TensorFlow, TensorFlow Lite</td><td>TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX</td><td>TensorFlow, TensorFlow Lite, Keras, PyTorch, ONNX</td></tr><tr><td><strong>支持模型</strong></td><td>MobileNet, Inception, EfficientNet 等</td><td>ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等</td><td>ResNet-50, MobileNet_v2, SSD, YOLOv3, YOLOv5 等</td></tr><tr><td><strong>模型功能</strong></td><td>对象识别、对象分类，语义分割，姿态识别，音频分类</td><td>对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等</td><td>对象识别、对象分类，语义分割，姿态识别，深度估计，人脸检测，人脸识别等</td></tr><tr><td><strong>硬件性能</strong></td><td>4 TOPS</td><td>26 TOPS</td><td>13 TOPS</td></tr><tr><td><strong>发布时间</strong></td><td>2019年</td><td>2021年</td><td>2023年</td></tr><tr><td><strong>功耗</strong></td><td>0.5-2 W</td><td>2.5-4.6 W</td><td>1.8-3.2 W</td></tr><tr><td><strong>每W性能</strong></td><td>8 TOPS/W</td><td>10.4 TOPS/W</td><td>7.2 TOPS/W</td></tr><tr><td><strong>当前价格</strong></td><td>约300~1000¥</td><td>约 1300¥</td><td>约550¥</td></tr><tr><td><strong>支持的操作系统</strong></td><td>Linux, Windows, MacOS</td><td>Linux, Windows</td><td>Linux, Windows</td></tr><tr><td><strong>可扩展性</strong></td><td>不支持多芯片</td><td>支持多芯片并行处理</td><td>支持多芯片并行处理</td></tr><tr><td><strong>应用领域</strong></td><td>物联网设备、嵌入式系统</td><td>工业自动化、智能监控、自动驾驶</td><td>工业自动化、智能监控、智能零售</td></tr></tbody></table><p>Frigate 的最新的代码已经合并了 Hailo8L 的 PR，预计将会在 0.15 版本中正式发布，PR 参考 <a href=https://github.com/blakeblackshear/frigate/pull/12431>Initial support for Hailo-8L</a> 和 <a href=https://github.com/blakeblackshear/frigate/pull/12820>Hailo amd64 support</a>；虽然 PR 中支持的设备是 Hailo-8L，但是经过测试验证，只需要替换对应的模型，Hailo-8 也是可以正常运行的（Hailo-8 和 Hailo-8L 的模型不能互相使用）</p><h2 id=frigate-使用-hailo88l>Frigate 使用 Hailo8/8L</h2><p>使用之前，需要确保 Hailo 的 PCIE Driver 已经正确安装，参考 <a href=https://blog.hellowood.dev/posts/ubuntu22-%E5%AE%89%E8%A3%85%E5%88%9D%E5%A7%8B%E5%8C%96-hailo-8%E7%B3%BB%E5%88%97-tpu-%E5%8A%A0%E9%80%9F%E5%99%A8/>Ubuntu22 安装初始化 Hailo 8系列 TPU 加速器</a></p><h3 id=将-hailo-设备挂载到容器>将 Hailo 设备挂载到容器</h3><ul><li>docker-compose.yaml</li></ul><p>注意，<code>ghcr.io/helloworlde/frigate:0.15-f4d311c-h8l</code> 是基于 4.18 版本的驱动的，而 Frigate 的仓库是基于 4.17 版本的驱动，如果驱动和容器中的运行环境版本不一致，可能会导致 Hailo 调用失败；最新的镜像版本可以在 <a href=https://github.com/blakeblackshear/frigate/pkgs/container/frigate>Packages</a> 中查找</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>frigate-hailo</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>frigate-hailo</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>privileged</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>ghcr.io/helloworlde/frigate:0.15-f4d311c-h8l</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>shm_size</span>: <span style=color:#ae81ff>512mb</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>devices</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>/dev/hailo0:/dev/hailo0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>/etc/localtime:/etc/localtime:ro</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>./config/:/config</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>./data/db/:/data/db</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>./data/storage:/media/frigate</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>type</span>: <span style=color:#ae81ff>tmpfs</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>target</span>: <span style=color:#ae81ff>/tmp/cache</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>tmpfs</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>size</span>: <span style=color:#ae81ff>1000000000</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>5000</span>:<span style=color:#ae81ff>5000</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>TZ=Asia/Shanghai</span>
</span></span></code></pre></div><h3 id=修改配置文件>修改配置文件</h3><p>配置文件路径是 <code>./config/config.yml</code>；指定了 detector 使用 hailo8l，并且指定了模型的路径；如果该路径下没有模型，会自动从 S3 下载；默认使用的是 ssd_mobilenet_v1 模型</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>database</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/data/db/frigate.db</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>cameras</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>bedroom</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>ffmpeg</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>path</span>: <span style=color:#ae81ff>rtsp://admin:123456@192.168.31.100:554/stream1&amp;channel=1</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>roles</span>:
</span></span><span style=display:flex><span>            - <span style=color:#ae81ff>record</span>
</span></span><span style=display:flex><span>            - <span style=color:#ae81ff>detect</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>objects</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>track</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>person</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>cat</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>detectors</span>:
</span></span><span style=display:flex><span> <span style=color:#f92672>hailo8l</span>:
</span></span><span style=display:flex><span>   <span style=color:#f92672>type</span>: <span style=color:#ae81ff>hailo8l</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>device</span>: <span style=color:#ae81ff>PCIe</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>model</span>:
</span></span><span style=display:flex><span>     <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/config/model_cache/h8l_cache/ssd_mobilenet_v1.hef</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>model</span>:
</span></span><span style=display:flex><span> <span style=color:#f92672>width</span>: <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>height</span>: <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>input_tensor</span>: <span style=color:#ae81ff>nhwc</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>input_pixel_format</span>: <span style=color:#ae81ff>bgr</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>model_type</span>: <span style=color:#ae81ff>ssd</span>
</span></span></code></pre></div><p>如果使用的是 Hailo-8，则需要下载 Hailo-8 的模型到本地挂载到容器中，并修改配置为模型对应的配置；Hailo-8 的模型可以从 <a href=https://github.com/hailo-ai/hailo_model_zoo/blob/master/docs/public_models/HAILO8/HAILO8_object_detection.rst>Public Pre-Trained Models</a> 下载，以 yolov8n 为例，修改 path、width 和 height 即可</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>detectors</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>hailo8l</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>hailo8l</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>device</span>: <span style=color:#ae81ff>PCIe</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>model</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/config/model_cache/h8_cache/yolov8n.hef</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>model</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>width</span>: <span style=color:#ae81ff>640</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>height</span>: <span style=color:#ae81ff>640</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>input_tensor</span>: <span style=color:#ae81ff>nhwc</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>input_pixel_format</span>: <span style=color:#ae81ff>bgr</span>
</span></span></code></pre></div><p>使用 12个 1080p 的监控，以 5fps 进行视频内容识别，使用 hailo-8 和 yolox 模型的推理速度约为 60ms，使用 hailo-8/8L 和 ssd_mobilenet_v1 模型的推理速度约为 15ms，而 Google Coral TPU 的推理速度约为 8ms；在当前的 Frigate 版本下，使用 Google Coral TPU 和小模型检测对象更快</p><p><img alt=homelab-frigate-tpu-hailo-8-system-metrics.png src=https://img.hellowood.dev/picture/homelab-frigate-tpu-hailo-8-system-metrics.png></p><h2 id=遇到的问题>遇到的问题</h2><h3 id=invalid-general-ioctl-code-0x400c6705>Invalid general ioctl code 0x400c6705</h3><p>使用官方的镜像启动后包错，提示 hailo_platform.pyhailort._pyhailort.HailoRTStatusException，检查 dmesg 发现错误信息为 <code>Invalid general ioctl code 0x400c6705</code>，这是因为驱动版本不一致导致的；官方镜像中的版本为 4.17，而本地安装的驱动版本为 4.18，导致命令无法识别；重新安装 4.17 版本的驱动，或者将 Frigate 镜像中的 HailoRT 版本改为相同的即可</p><p>frigate 日志：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.835191724</span>  [<span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44</span>] frigate<span style=color:#f92672>.</span>detectors<span style=color:#f92672>.</span>plugins<span style=color:#f92672>.</span>hailo8l ERROR   : HailoRTException during initialization: PCIe driver failure<span style=color:#f92672>.</span> run <span style=color:#e6db74>&#39;dmesg | grep hailo&#39;</span> <span style=color:#66d9ef>for</span> more information
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.836911083</span>  Traceback (most recent call last):
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.836918597</span>    File <span style=color:#e6db74>&#34;/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py&#34;</span>, line <span style=color:#ae81ff>2610</span>, <span style=color:#f92672>in</span> _open_vdevice
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.836919078</span>      self<span style=color:#f92672>.</span>_vdevice <span style=color:#f92672>=</span> _pyhailort<span style=color:#f92672>.</span>VDevice<span style=color:#f92672>.</span>create(self<span style=color:#f92672>.</span>_params, device_ids)
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.836928015</span>  hailo_platform<span style=color:#f92672>.</span>pyhailort<span style=color:#f92672>.</span>_pyhailort<span style=color:#f92672>.</span>HailoRTStatusException: <span style=color:#ae81ff>36</span>
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837285278</span>
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837286139</span>  The above exception was the direct cause of the following exception:
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837286440</span>
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837286760</span>  Traceback (most recent call last):
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837302350</span>    File <span style=color:#e6db74>&#34;/usr/lib/python3.9/multiprocessing/process.py&#34;</span>, line <span style=color:#ae81ff>315</span>, <span style=color:#f92672>in</span> _bootstrap
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837302841</span>      self<span style=color:#f92672>.</span>run()
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837308171</span>    File <span style=color:#e6db74>&#34;/usr/lib/python3.9/multiprocessing/process.py&#34;</span>, line <span style=color:#ae81ff>108</span>, <span style=color:#f92672>in</span> run
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837308732</span>      self<span style=color:#f92672>.</span>_target(<span style=color:#f92672>*</span>self<span style=color:#f92672>.</span>_args, <span style=color:#f92672>**</span>self<span style=color:#f92672>.</span>_kwargs)
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837309313</span>    File <span style=color:#e6db74>&#34;/opt/frigate/frigate/object_detection.py&#34;</span>, line <span style=color:#ae81ff>102</span>, <span style=color:#f92672>in</span> run_detector
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837309904</span>      object_detector <span style=color:#f92672>=</span> LocalObjectDetector(detector_config<span style=color:#f92672>=</span>detector_config)
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837318260</span>    File <span style=color:#e6db74>&#34;/opt/frigate/frigate/object_detection.py&#34;</span>, line <span style=color:#ae81ff>53</span>, <span style=color:#f92672>in</span> __init__
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837318961</span>      self<span style=color:#f92672>.</span>detect_api <span style=color:#f92672>=</span> create_detector(detector_config)
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837319482</span>    File <span style=color:#e6db74>&#34;/opt/frigate/frigate/detectors/__init__.py&#34;</span>, line <span style=color:#ae81ff>18</span>, <span style=color:#f92672>in</span> create_detector
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837319943</span>      <span style=color:#66d9ef>return</span> api(detector_config)
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837320514</span>    File <span style=color:#e6db74>&#34;/opt/frigate/frigate/detectors/plugins/hailo8l.py&#34;</span>, line <span style=color:#ae81ff>73</span>, <span style=color:#f92672>in</span> __init__
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837322888</span>      self<span style=color:#f92672>.</span>target <span style=color:#f92672>=</span> VDevice()
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837328058</span>    File <span style=color:#e6db74>&#34;/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py&#34;</span>, line <span style=color:#ae81ff>2603</span>, <span style=color:#f92672>in</span> __init__
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837328599</span>      self<span style=color:#f92672>.</span>_open_vdevice()
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837329281</span>    File <span style=color:#e6db74>&#34;/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py&#34;</span>, line <span style=color:#ae81ff>2610</span>, <span style=color:#f92672>in</span> _open_vdevice
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837329902</span>      self<span style=color:#f92672>.</span>_vdevice <span style=color:#f92672>=</span> _pyhailort<span style=color:#f92672>.</span>VDevice<span style=color:#f92672>.</span>create(self<span style=color:#f92672>.</span>_params, device_ids)
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837330623</span>    File <span style=color:#e6db74>&#34;/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py&#34;</span>, line <span style=color:#ae81ff>111</span>, <span style=color:#f92672>in</span> __exit__
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837331394</span>      self<span style=color:#f92672>.</span>_raise_indicative_status_exception(value)
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837338017</span>    File <span style=color:#e6db74>&#34;/usr/local/lib/python3.9/dist-packages/hailo_platform/pyhailort/pyhailort.py&#34;</span>, line <span style=color:#ae81ff>146</span>, <span style=color:#f92672>in</span> _raise_indicative_status_exception
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837338959</span>      <span style=color:#66d9ef>raise</span> HailoRTPCIeDriverException(<span style=color:#e6db74>&#34;PCIe driver failure. run &#39;dmesg | grep hailo&#39; for more information&#34;</span>) <span style=color:#f92672>from</span> libhailort_exception
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>51</span>:<span style=color:#ae81ff>44.837357273</span>  hailo_platform<span style=color:#f92672>.</span>pyhailort<span style=color:#f92672>.</span>pyhailort<span style=color:#f92672>.</span>HailoRTPCIeDriverException: PCIe driver failure<span style=color:#f92672>.</span> run <span style=color:#e6db74>&#39;dmesg | grep hailo&#39;</span> <span style=color:#66d9ef>for</span> more information
</span></span></code></pre></div><p>查看 dmesg 日志：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dmesg | grep hailo
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>   67.062136<span style=color:#f92672>]</span> hailo_pci: loading out-of-tree module taints kernel.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>   67.062191<span style=color:#f92672>]</span> hailo_pci: module verification failed: signature and/or required key missing - tainting kernel
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>   67.068815<span style=color:#f92672>]</span> hailo: Init module. driver version 4.18.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>   67.069665<span style=color:#f92672>]</span> hailo 0000:04:00.0: Probing on: 1e60:2864...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>   67.069670<span style=color:#f92672>]</span> hailo 0000:04:00.0: Probing: Allocate memory <span style=color:#66d9ef>for</span> device extension, <span style=color:#ae81ff>11632</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>  188.404620<span style=color:#f92672>]</span> hailo 0000:04:00.0: Invalid general ioctl code 0x400c6705 <span style=color:#f92672>(</span>nr: 5<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>修改为相同版本镜像后 Hailo 成功加载:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>33.745564255</span>  [<span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>33</span>] frigate<span style=color:#f92672>.</span>detectors<span style=color:#f92672>.</span>plugins<span style=color:#f92672>.</span>hailo8l INFO    : A model file already exists at <span style=color:#f92672>/</span>config<span style=color:#f92672>/</span>model_cache<span style=color:#f92672>/</span>h8l_cache<span style=color:#f92672>/</span>ssd_mobilenet_v1<span style=color:#f92672>.</span>hef <span style=color:#f92672>not</span> downloading one<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>frigate<span style=color:#f92672>-</span>hailo  <span style=color:#f92672>|</span> <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>33.871380296</span>  [<span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>08</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>33</span>] frigate<span style=color:#f92672>.</span>detectors<span style=color:#f92672>.</span>plugins<span style=color:#f92672>.</span>hailo8l INFO    : Hailo device initialized successfully
</span></span></code></pre></div><h2 id=参考文档>参考文档</h2><ul><li><a href=https://github.com/hailo-ai/hailo_model_zoo/blob/master/docs/public_models/HAILO8L/HAILO8L_object_detection.rst>HAILO8L 对象识别模型</a></li><li><a href=https://github.com/hailo-ai/hailo_model_zoo/blob/master/docs/public_models/HAILO8/HAILO8_object_detection.rst>HAILO8 对象识别模型</a></li><li><a href=https://github.com/helloworlde/frigate/commit/f4d311c4c8fbeb8cd9e16b5bfbb60f3d276a00dd>修改 Frigate HailoRT 版本为 4.18</a></li><li><a href=https://community.hailo.ai/t/hailortpciedriverexception-pcie-driver-failure/2358/2>HailoRTPCIeDriverException: PCIe driver failure</a></li></ul></section><div class=paginator><a class=next href=https://blog.hellowood.dev/posts/ubuntu22-%E5%AE%89%E8%A3%85%E5%88%9D%E5%A7%8B%E5%8C%96-hailo-8%E7%B3%BB%E5%88%97-tpu-%E5%8A%A0%E9%80%9F%E5%99%A8/><span>Ubuntu22 安装初始化 Hailo 8系列 TPU 加速器</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div><div class=related-resources><h3>Related Resources</h3><nav><ul><li><a href=/posts/%E5%9F%BA%E4%BA%8E-frigate-%E4%BD%BF%E7%94%A8-double-take-%E5%92%8C-deepstack-%E5%AF%B9%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E8%BF%9B%E8%A1%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/>基于 Frigate 使用 Double Take 和 DeepStack 对视频监控进行人脸识别</a></li></ul></nav><h3>Related Resources</h3><nav><ul><li><a href=/posts/%E5%9F%BA%E4%BA%8E-frigate-%E4%BD%BF%E7%94%A8-double-take-%E5%92%8C-deepstack-%E5%AF%B9%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E8%BF%9B%E8%A1%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/>基于 Frigate 使用 Double Take 和 DeepStack 对视频监控进行人脸识别</a></li><li><a href=/posts/%E4%BD%BF%E7%94%A8%E5%AE%B6%E5%BA%AD%E5%AE%BD%E5%B8%A6%E5%85%AC%E7%BD%91-ipv6-%E8%87%AA%E5%BB%BA-tailscale-%E7%9A%84-derp-%E8%8A%82%E7%82%B9/>使用家庭宽带公网 IPV6 自建 Tailscale 的 DERP 节点</a></li><li><a href=/posts/ubuntu-22-%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96/>Ubuntu 22 环境初始化</a></li><li><a href=/posts/proxmox-ve-%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84-lxc-%E5%AE%B9%E5%99%A8-ct-%E6%A8%A1%E6%9D%BF/>Proxmox VE 创建自定义的 LXC 容器 CT 模板</a></li><li><a href=/posts/%E5%9C%A8%E9%BB%91%E7%BE%A4%E6%99%96%E4%BD%BF%E7%94%A8-docker-%E9%83%A8%E7%BD%B2-proxmox-backup-server/>在黑群晖使用 Docker 部署 Proxmox Backup Server</a></li><li><a href=/posts/%E4%BD%BF%E7%94%A8%E9%98%BF%E5%B0%94%E5%8D%A1%E7%89%B9%E7%8C%AB%E6%A3%92%E6%9B%BF%E6%8D%A2%E5%8C%97%E4%BA%AC%E7%A7%BB%E5%8A%A8-gpon-%E5%85%89%E7%8C%AB/>使用阿尔卡特猫棒替换北京移动 GPON 光猫</a></li><li><a href=/posts/%E4%BD%BF%E7%94%A8cloudflare-tunnels%E9%80%9A%E8%BF%87web-ssh%E8%AE%BF%E9%97%AE%E6%9C%8D%E5%8A%A1%E5%99%A8/>使用 Cloudflare Tunnels 通过 Web SSH 访问服务器</a></li><li><a href=/posts/linux%E7%8E%AF%E5%A2%83%E4%B8%8B%E9%85%8D%E7%BD%AE%E4%B8%8D%E9%97%B4%E6%96%AD%E7%94%B5%E6%BA%90ups/>Linux 环境下配置不间断电源 UPS</a></li><li><a href=/posts/%E4%BD%BF%E7%94%A8-ubuntu-%E6%90%AD%E5%BB%BA-nfs-%E6%9C%8D%E5%8A%A1%E5%99%A8/>使用 Ubuntu 搭建 NFS 服务器</a></li></ul></nav><h3>Related Resources</h3><nav><ul><li><a href=/posts/%E5%9F%BA%E4%BA%8E-frigate-%E4%BD%BF%E7%94%A8-double-take-%E5%92%8C-deepstack-%E5%AF%B9%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E8%BF%9B%E8%A1%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/>基于 Frigate 使用 Double Take 和 DeepStack 对视频监控进行人脸识别</a></li></ul></nav><h3>Related Resources</h3><nav><ul><li><a href=/posts/ubuntu22-%E5%AE%89%E8%A3%85%E5%88%9D%E5%A7%8B%E5%8C%96-hailo-8%E7%B3%BB%E5%88%97-tpu-%E5%8A%A0%E9%80%9F%E5%99%A8/>Ubuntu22 安装初始化 Hailo 8系列 TPU 加速器</a></li></ul></nav><h3>Related Resources</h3><nav><ul><li><a href=/posts/ubuntu22-%E5%AE%89%E8%A3%85%E5%88%9D%E5%A7%8B%E5%8C%96-hailo-8%E7%B3%BB%E5%88%97-tpu-%E5%8A%A0%E9%80%9F%E5%99%A8/>Ubuntu22 安装初始化 Hailo 8系列 TPU 加速器</a></li></ul></nav></div></article></div><footer class=footer><p>&copy; 2024 <a href=https://blog.hellowood.dev/>HelloWood</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank data-umami-event=to-hugo>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank data-umami-event=to-ladder>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g data-umami-event=top-link><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>