<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>Clash 使用 Docker 部署</title>
<meta name=description content="使用 Clash Premium 版本请参考 使用 Docker 部署 Clash Premium
在一些场景下无法使用 Clash 客户端进行代理，也无法使用软路由，这时候可以由一台服务器运行 Clash，作为其他客户端的代理；同时 Clash 支持以 Docker 容器的方式运行，方便部署和运维
订阅格式转换 机场 …"><meta name=keywords content='blog,hugo,Clash,Docker,HomeLab'><meta property="og:url" content="https://blog.hellowood.dev/posts/clash-%E4%BD%BF%E7%94%A8-docker-%E9%83%A8%E7%BD%B2/"><meta property="og:type" content="website"><meta property="og:title" content="Clash 使用 Docker 部署"><meta property="og:description" content="使用 Clash Premium 版本请参考 使用 Docker 部署 Clash Premium
在一些场景下无法使用 Clash 客户端进行代理，也无法使用软路由，这时候可以由一台服务器运行 Clash，作为其他客户端的代理；同时 Clash 支持以 Docker 容器的方式运行，方便部署和运维
订阅格式转换 机场 …"><meta property="og:image" content="https://blog.hellowood.dev/images/avatar.webp"><meta property="og:image:secure_url" content="https://blog.hellowood.dev/images/avatar.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Clash 使用 Docker 部署"><meta name=twitter:description content="使用 Clash Premium 版本请参考 使用 Docker 部署 Clash Premium
在一些场景下无法使用 Clash 客户端进行代理，也无法使用软路由，这时候可以由一台服务器运行 Clash，作为其他客户端的代理；同时 Clash 支持以 Docker 容器的方式运行，方便部署和运维
订阅格式转换 机场 …"><meta property="twitter:domain" content="https://blog.hellowood.dev/posts/clash-%E4%BD%BF%E7%94%A8-docker-%E9%83%A8%E7%BD%B2/"><meta property="twitter:url" content="https://blog.hellowood.dev/posts/clash-%E4%BD%BF%E7%94%A8-docker-%E9%83%A8%E7%BD%B2/"><meta name=twitter:image content="https://blog.hellowood.dev/images/avatar.webp"><link rel=canonical href=https://blog.hellowood.dev/posts/clash-%E4%BD%BF%E7%94%A8-docker-%E9%83%A8%E7%BD%B2/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.9a920d7dabdbad8363b6a0a94e29a9dfebdb7ee64cfcb193a0145e512ef2bdab.js integrity="sha256-mpINfavbrYNjtqCpTimp3+vbfuZM/LGToBReUS7yvas="></script><script defer src=https://umami.hellowood.dev/script.js data-website-id=7a9034de-0ce7-4756-942a-829e6cd22301></script><script defer src=https://cloud.umami.is/script.js data-website-id=73ff1c8c-9938-43cf-81af-e77e26b0cca3></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "b2e481d136dc428c8c96c8673e2a04cf"}'></script><meta name=google-adsense-account content="ca-pub-3401351766168985"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3401351766168985" crossorigin=anonymous></script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","jtbhx98g62")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-3MSGPYTHPZ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3MSGPYTHPZ")</script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.hellowood.dev/><img src=/images/avatar.webp alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.hellowood.dev/>HelloWood</a></div><div class=nav-links><div class=nav-link><a href=https://blog.hellowood.dev/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://blog.hellowood.dev/posts/><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://blog.hellowood.dev/tags/><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://github.com/helloworlde><span data-feather=github></span></a></div><div class=nav-link><a href=https://umami.hellowood.dev/share/lab/Blog><span data-feather=pie-chart></span></a></div><div class=nav-link><a href=https://blog.hellowood.dev/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target"></span>
<a><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.hellowood.dev/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://blog.hellowood.dev/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://blog.hellowood.dev/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://github.com/helloworlde><span data-feather=github></span></a></li><li class=nav-item><a href=https://umami.hellowood.dev/share/lab/Blog><span data-feather=pie-chart></span></a></li><li class=nav-item><a href=https://blog.hellowood.dev/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>Clash 使用 Docker 部署</h1><small role=doc-subtitle></small><p class=post-date>2022-10-10</p><ul class=post-tags><li class=post-tag><a href=https://blog.hellowood.dev/tags/clash>Clash</a></li><li class=post-tag><a href=https://blog.hellowood.dev/tags/docker>Docker</a></li><li class=post-tag><a href=https://blog.hellowood.dev/tags/homelab>HomeLab</a></li></ul></div><div class=post-content><p>使用 Clash Premium 版本请参考 <a href=https://blog.hellowood.dev/posts/%E4%BD%BF%E7%94%A8docker%E9%83%A8%E7%BD%B2clash-premium/>使用 Docker 部署 Clash Premium</a></p><p>在一些场景下无法使用 Clash 客户端进行代理，也无法使用软路由，这时候可以由一台服务器运行 Clash，作为其他客户端的代理；同时 Clash 支持以 Docker 容器的方式运行，方便部署和运维</p><h2 id=订阅格式转换>订阅格式转换</h2><p>机场提供的订阅可能无法被 Clash 直接使用，或者分流配置不合理，需要转换格式；可以使用在线的订阅转换工具，如 <a href=https://acl4ssr-sub.github.io/>https://acl4ssr-sub.github.io/</a>等，也可以使用开源的服务自行搭建；</p><p>为了安全和隐私，可以基于 <a href=https://github.com/CareyWang/sub-web>https://github.com/CareyWang/sub-web</a> 和 <a href=https://github.com/tindy2013/subconverter>https://github.com/tindy2013/subconverter</a> 服务搭建，分别是前端和后端服务</p><ul><li>docker-compose.yaml</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#e06c75>version</span>: <span style=color:#63c381>&#34;3&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#e06c75>subweb</span>:
</span></span><span style=display:flex><span>    <span style=color:#e06c75>image</span>: <span style=color:#98c379>careywong/subweb</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>container_name</span>: <span style=color:#98c379>subweb</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>hostname</span>: <span style=color:#98c379>subweb</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>restart</span>: <span style=color:#98c379>unless-stopped</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#d19a66>18080</span>:<span style=color:#d19a66>80</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#98c379>TZ=Asia/Shanghai</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>subconverter</span>:
</span></span><span style=display:flex><span>    <span style=color:#e06c75>image</span>: <span style=color:#98c379>tindy2013/subconverter</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>container_name</span>: <span style=color:#98c379>subconverter</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>hostname</span>: <span style=color:#98c379>subconverter</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>restart</span>: <span style=color:#98c379>unless-stopped</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#d19a66>25500</span>:<span style=color:#d19a66>25500</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#98c379>TZ=Asia/Shanghai</span>
</span></span></code></pre></div><p>部署完成后，选择进阶模式，填写后端地址为 subconverter 容器的地址；选择远程配置（推荐 Ytoo/NyanCAT，配置更全面），然后填入订阅链接生成即可得到新的订阅链接</p><p><img src=https://img.hellowood.dev/picture/homelab-clash-proxy-config-convert-to-clash.png alt=homelab-clash-proxy-config-convert-to-clash.png></p><ul><li>自定义配置</li></ul><p>如果有自定义配置，可以指定远程配置，参考<a href=https://github.com/tindy2013/subconverter/blob/master/README-cn.md#%E5%A4%96%E9%83%A8%E9%85%8D%E7%BD%AE>外部配置</a>，指定 <code>clash_rule_base</code> 配置模板；不过该方式比较麻烦，自己使用可以直接通过更改 subconverter 默认配置的方式实现；</p><p>subconverter 默认的配置是 <code>/base/pref.toml</code>文件，其中指定了 clash 的配置文件模板为 <code>clash_rule_base = "base/all_base.tpl"</code>，所以修改 <code>base/all_base.tpl</code> 文件即可</p><p>为了监控 Clash Premium，需要开启 tracing，所以向配置文件 <code>base/all_base.tpl</code> 中直接加入相关配置：</p><pre tabindex=0><code>{% if request.target == &#34;clash&#34; or request.target == &#34;clashr&#34; %}
# 以下是新增内容
profile:
  tracing: true

# ...
{% endif %}
</code></pre><p>随后，将该配置文件复制到宿主机上，通过挂载文件的方式添加到 subconverter 容器，避免容器重启后丢失</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#e06c75>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#e06c75>subconverter</span>:
</span></span><span style=display:flex><span>    <span style=color:#e06c75>image</span>: <span style=color:#98c379>tindy2013/subconverter</span>
</span></span><span style=display:flex><span>    <span style=color:#8a93a5;font-style:italic># ...</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#98c379>./config/all_base.tpl://base/base/all_base.tpl</span>
</span></span></code></pre></div><h2 id=配置文件>配置文件</h2><p>在订阅格式转换完成后，就可以通过生成的订阅链接获取配置，这个配置可以直接使用；如果不满足需求可以基于该配置手动修改，配置内容格式如下：</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># 开启监控</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>profile</span>:
</span></span><span style=display:flex><span>  <span style=color:#e06c75>tracing</span>: <span style=color:#b756ff;font-weight:700>true</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>port</span>: <span style=color:#d19a66>7890</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>socks-port</span>: <span style=color:#d19a66>7891</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic>#转发端口一定要配置</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>redir-port</span>: <span style=color:#d19a66>7892</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic>#允许接管局域网流量</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>allow-lan</span>: <span style=color:#b756ff;font-weight:700>true</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic>#默认代理模式</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>mode</span>: <span style=color:#98c379>Rule</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>log-level</span>: <span style=color:#98c379>debug</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic>#接口控制端口是9090</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>external-controller</span>: :<span style=color:#d19a66>9090</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic>#如果服务器对公网开放可以设置密码</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>secret</span>: <span style=color:#63c381>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic>#配置由clash接管的dns解析</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>dns</span>:
</span></span><span style=display:flex><span>  <span style=color:#e06c75>enable</span>: <span style=color:#b756ff;font-weight:700>true</span>
</span></span><span style=display:flex><span>  <span style=color:#8a93a5;font-style:italic>#主要监听定向转发来的数据，后续会在路由表里配置转发端口为1053</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>listen</span>: <span style=color:#d19a66>0.0.0.0</span>:<span style=color:#d19a66>1053</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>enhanced-mode</span>: <span style=color:#98c379>fake-ip</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>nameserver</span>:
</span></span><span style=display:flex><span>    - <span style=color:#63c381>&#34;114.114.114.114&#34;</span>
</span></span><span style=display:flex><span>    - <span style=color:#63c381>&#34;223.5.5.5&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>fallback</span>:
</span></span><span style=display:flex><span>    - <span style=color:#63c381>&#34;tls://1.1.1.1:853&#34;</span>
</span></span><span style=display:flex><span>    - <span style=color:#63c381>&#34;tcp://1.1.1.1:53&#34;</span>
</span></span><span style=display:flex><span>    - <span style=color:#63c381>&#34;tcp://208.67.222.222:443&#34;</span>
</span></span><span style=display:flex><span>    - <span style=color:#63c381>&#34;tls://dns.google&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># 代理节点</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>proxies</span>:
</span></span><span style=display:flex><span>  - {
</span></span><span style=display:flex><span>      <span style=color:#e06c75>name</span>: <span style=color:#98c379>node1,</span>
</span></span><span style=display:flex><span>      <span style=color:#e06c75>server</span>: <span style=color:#d19a66>0.0.0.0</span>,
</span></span><span style=display:flex><span>      <span style=color:#e06c75>port</span>: <span style=color:#d19a66>5601</span>,
</span></span><span style=display:flex><span>      <span style=color:#e06c75>type</span>: <span style=color:#98c379>ss,</span>
</span></span><span style=display:flex><span>      <span style=color:#e06c75>cipher</span>: <span style=color:#98c379>aes-256-gcm,</span>
</span></span><span style=display:flex><span>      <span style=color:#e06c75>password</span>: <span style=color:#d19a66>1234</span>,
</span></span><span style=display:flex><span>      <span style=color:#e06c75>udp</span>: <span style=color:#b756ff;font-weight:700>true</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># 代理组</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>proxy-groups</span>:
</span></span><span style=display:flex><span>  - {
</span></span><span style=display:flex><span>      <span style=color:#e06c75>name</span>: <span style=color:#63c381>&#34;🚀 节点选择&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e06c75>type</span>: <span style=color:#98c379>select,</span>
</span></span><span style=display:flex><span>      <span style=color:#e06c75>proxies</span>: [<span style=color:#63c381>&#34;♻️ 自动选择&#34;</span>, <span style=color:#63c381>&#34;🚀 手动切换&#34;</span>, <span style=color:#98c379>DIRECT],</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># 分流规则</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>rules</span>:
</span></span><span style=display:flex><span>  - <span style=color:#63c381>&#34;DOMAIN-SUFFIX,local,🎯 全球直连&#34;</span>
</span></span><span style=display:flex><span>  - <span style=color:#63c381>&#34;DOMAIN-SUFFIX,localhost,🎯 全球直连&#34;</span>
</span></span><span style=display:flex><span>  - <span style=color:#63c381>&#34;IP-CIDR,10.0.0.0/8,🎯 全球直连,no-resolve&#34;</span>
</span></span></code></pre></div><h2 id=部署>部署</h2><p>Clash 有两个版本，一个是 clash，一个是 clash-premium，区别在于 premium 是非开源的，支持数据统计，支持 fake-ip 模式（能够减少一次 DNS 查询），支持订阅</p><p>yacd 是一个开源的 Clash 控制面板，功能较丰富</p><ul><li>Docker 命令运行</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run --name clash <span style=color:#d26464;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#d26464;font-weight:700></span>	 -d <span style=color:#d26464;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#d26464;font-weight:700></span>	 -v config.yaml:/root/.config/clash/config.yaml <span style=color:#d26464;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#d26464;font-weight:700></span>	 -p 7890:7890 <span style=color:#d26464;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#d26464;font-weight:700></span>	 -p 7891:7891 <span style=color:#d26464;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#d26464;font-weight:700></span>	 -p 9090:9090 <span style=color:#d26464;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#d26464;font-weight:700></span>	 dreamacro/clash-premium
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>docker run --name yacd <span style=color:#d26464;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#d26464;font-weight:700></span>	-d  <span style=color:#d26464;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#d26464;font-weight:700></span>	-p 80:80 <span style=color:#d26464;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#d26464;font-weight:700></span>	ghcr.io/haishanh/yacd:master
</span></span></code></pre></div><p><img src=https://img.hellowood.dev/picture/homelab-clash-proxy-yacd-ui.png alt=homelab-clash-proxy-yacd-ui.png></p><ul><li>docker-compose 方式运行</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#e06c75>version</span>: <span style=color:#63c381>&#34;3&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#e06c75>clash</span>:
</span></span><span style=display:flex><span>    <span style=color:#e06c75>image</span>: <span style=color:#98c379>dreamacro/clash-premium</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>container_name</span>: <span style=color:#98c379>clash</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>hostname</span>: <span style=color:#98c379>clash</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>restart</span>: <span style=color:#98c379>unless-stopped</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#d19a66>7890</span>:<span style=color:#d19a66>7890</span>
</span></span><span style=display:flex><span>      - <span style=color:#d19a66>7891</span>:<span style=color:#d19a66>7891</span>
</span></span><span style=display:flex><span>      - <span style=color:#d19a66>9090</span>:<span style=color:#d19a66>9090</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#98c379>./config.yaml:/root/.config/clash/config.yaml</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#98c379>TZ=Asia/Shanghai</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>yacd</span>:
</span></span><span style=display:flex><span>    <span style=color:#e06c75>image</span>: <span style=color:#98c379>ghcr.io/haishanh/yacd:master</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>container_name</span>: <span style=color:#98c379>yacd</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>hostname</span>: <span style=color:#98c379>yacd</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>restart</span>: <span style=color:#98c379>unless-stopped</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#d19a66>80</span>:<span style=color:#d19a66>80</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>environment</span>:
</span></span><span style=display:flex><span>      - <span style=color:#98c379>TZ=Asia/Shanghai</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>depends_on</span>:
</span></span><span style=display:flex><span>      - <span style=color:#98c379>clash</span>
</span></span></code></pre></div><h2 id=客户端使用>客户端使用</h2><p>通过容器方式部署的 Clash 可以以代理的方式使用，在手机/电脑或者应用程序中配置代理即可</p><h3 id=命令行>命令行</h3><p>开启代理</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ef8383>export</span> <span style=color:#dcaeea>https_proxy</span><span style=color:#c7bf54>=</span>http://192.168.2.2:7890
</span></span><span style=display:flex><span><span style=color:#ef8383>export</span> <span style=color:#dcaeea>http_proxy</span><span style=color:#c7bf54>=</span>http://192.168.2.2:7890
</span></span><span style=display:flex><span><span style=color:#ef8383>export</span> <span style=color:#dcaeea>all_proxy</span><span style=color:#c7bf54>=</span>socks5://192.168.2.2:7891
</span></span></code></pre></div><p>关闭代理</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ef8383>unset</span> http_proxy
</span></span><span style=display:flex><span><span style=color:#ef8383>unset</span> https_proxy
</span></span><span style=display:flex><span><span style=color:#ef8383>unset</span> all_proxy
</span></span></code></pre></div><h3 id=系统>系统</h3><p>在网络-代理中添加配置，指定 HTTP/HTTPS/SOCKS 代理为配置的代理即可</p><p><img src=https://img.hellowood.dev/picture/homelab-clash-proxy-config-macos.png alt=homelab-clash-proxy-config-macos.png></p></div><div class=prev-next></div><svg id="btt-button" class="arrow-logo" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script><div id=comments><script src=https://utteranc.es/client.js repo=helloworlde/helloworlde.github.io issue-term=title theme=github-light crossorigin=anonymous async></script></div></div></main><footer class=footer><span>&copy; 2024 hellowood.dev</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>