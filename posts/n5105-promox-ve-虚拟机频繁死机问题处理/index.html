<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>N5105 Promox VE 虚拟机频繁死机问题处理</title>
<meta charset=utf-8><meta name=description content="Ladder@N5105 Promox VE 虚拟机频繁死机问题处理 使用 N5105 作为 HomeLab 的服务器；之前安装的 ESXi，使用 Ubuntu 22 的时候经常会出现 Ubuntu CPU 占用达到100%，然后死机；但是其他的虚拟机都没有问题，因为对 Linux 并不熟，查看了 ESXi 和 Ubuntu 日志并没有异常；后面安装黑群晖一直失败，因此换到了 Proxmox VE
换到 PVE 后依然存在同样的问题，以为是服务的问题，于是给 Docker 容器添加了资源限制，无效后迁移到了 CentOS 部署，发现还是同样的问题；并且越来越频繁，从一天一次变成了几小时一次，几乎无法使用
猜测会不会是硬件问题，一番搜索发现在 N5105 上居然是个普遍的问题
问题 这个问题于 2022-08-04 在 Proxmox 的问题反馈中提交：Bug 4188 - VMs freeze on Intel N5105 CPU，描述中&#34;到运行Intel N5105 CPU的一些用户注意到在Proxmox上运行的虚拟机会冻结，并记录了各种错误。虚拟机会冻结，控制台无法输入，CPU利用率达到最大值，直到强制重启虚拟机&#34;，现象和我遇到的是一样的，说明该现象是通病；
2022-9-13 在帖子 Opt-in Linux 5.19 Kernel for Proxmox VE 7.x available 中，PVE员工宣布将 PVE 的内核升级到 5.19版本，在 Bug 反馈到讨论中有不少人确认有效
这个问题在 2022-12-06 状态变更为 &lsquo;FIX PACKAGED&rsquo;；在 2022-12-14，PVE员工宣布支持将内核升级到 6."><meta name=author content="HelloWood"><link rel=canonical href=https://blog.hellowood.dev/posts/n5105-promox-ve-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%A2%91%E7%B9%81%E6%AD%BB%E6%9C%BA%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/><meta name=google-site-verification content="G-3MSGPYTHPZ"><link rel=alternate type=application/rss+xml href=https://blog.hellowood.dev/index.xml title=HelloWood><script async src="https://www.googletagmanager.com/gtag/js?id=G-3MSGPYTHPZ"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3MSGPYTHPZ",{anonymize_ip:!1})}</script><script async defer data-website-id=7a9034de-0ce7-4756-942a-829e6cd22301 src=https://umami.hellowood.dev/script.js></script><script defer data-cf-beacon='{"token": "b2e481d136dc428c8c96c8673e2a04cf"}' src=https://static.cloudflareinsights.com/beacon.min.js></script><meta property="og:title" content="N5105 Promox VE 虚拟机频繁死机问题处理"><meta property="og:description" content="N5105 Promox VE 虚拟机频繁死机问题处理 使用 N5105 作为 HomeLab 的服务器；之前安装的 ESXi，使用 Ubuntu 22 的时候经常会出现 Ubuntu CPU 占用达到100%，然后死机；但是其他的虚拟机都没有问题，因为对 Linux 并不熟，查看了 ESXi 和 Ubuntu 日志并没有异常；后面安装黑群晖一直失败，因此换到了 Proxmox VE
换到 PVE 后依然存在同样的问题，以为是服务的问题，于是给 Docker 容器添加了资源限制，无效后迁移到了 CentOS 部署，发现还是同样的问题；并且越来越频繁，从一天一次变成了几小时一次，几乎无法使用
猜测会不会是硬件问题，一番搜索发现在 N5105 上居然是个普遍的问题
问题 这个问题于 2022-08-04 在 Proxmox 的问题反馈中提交：Bug 4188 - VMs freeze on Intel N5105 CPU，描述中&#34;到运行Intel N5105 CPU的一些用户注意到在Proxmox上运行的虚拟机会冻结，并记录了各种错误。虚拟机会冻结，控制台无法输入，CPU利用率达到最大值，直到强制重启虚拟机&#34;，现象和我遇到的是一样的，说明该现象是通病；
2022-9-13 在帖子 Opt-in Linux 5.19 Kernel for Proxmox VE 7.x available 中，PVE员工宣布将 PVE 的内核升级到 5.19版本，在 Bug 反馈到讨论中有不少人确认有效
这个问题在 2022-12-06 状态变更为 &lsquo;FIX PACKAGED&rsquo;；在 2022-12-14，PVE员工宣布支持将内核升级到 6."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.hellowood.dev/posts/n5105-promox-ve-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%A2%91%E7%B9%81%E6%AD%BB%E6%9C%BA%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-25T21:31:50+08:00"><meta property="article:modified_time" content="2023-03-25T21:31:50+08:00"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/proxmox-ve-%E6%B7%BB%E5%8A%A0%E7%9B%91%E6%8E%A7/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/openwrt-%E5%9C%A8-pve-%E4%B8%AD%E4%BB%A5%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%96%B9%E5%BC%8F%E5%AE%89%E8%A3%85/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/proxmox-ve-%E5%AE%89%E8%A3%85%E5%88%9D%E5%A7%8B%E5%8C%96/"><meta name=twitter:card content="summary"><meta name=twitter:title content="N5105 Promox VE 虚拟机频繁死机问题处理"><meta name=twitter:description content="N5105 Promox VE 虚拟机频繁死机问题处理 使用 N5105 作为 HomeLab 的服务器；之前安装的 ESXi，使用 Ubuntu 22 的时候经常会出现 Ubuntu CPU 占用达到100%，然后死机；但是其他的虚拟机都没有问题，因为对 Linux 并不熟，查看了 ESXi 和 Ubuntu 日志并没有异常；后面安装黑群晖一直失败，因此换到了 Proxmox VE
换到 PVE 后依然存在同样的问题，以为是服务的问题，于是给 Docker 容器添加了资源限制，无效后迁移到了 CentOS 部署，发现还是同样的问题；并且越来越频繁，从一天一次变成了几小时一次，几乎无法使用
猜测会不会是硬件问题，一番搜索发现在 N5105 上居然是个普遍的问题
问题 这个问题于 2022-08-04 在 Proxmox 的问题反馈中提交：Bug 4188 - VMs freeze on Intel N5105 CPU，描述中&#34;到运行Intel N5105 CPU的一些用户注意到在Proxmox上运行的虚拟机会冻结，并记录了各种错误。虚拟机会冻结，控制台无法输入，CPU利用率达到最大值，直到强制重启虚拟机&#34;，现象和我遇到的是一样的，说明该现象是通病；
2022-9-13 在帖子 Opt-in Linux 5.19 Kernel for Proxmox VE 7.x available 中，PVE员工宣布将 PVE 的内核升级到 5.19版本，在 Bug 反馈到讨论中有不少人确认有效
这个问题在 2022-12-06 状态变更为 &lsquo;FIX PACKAGED&rsquo;；在 2022-12-14，PVE员工宣布支持将内核升级到 6."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://blog.hellowood.dev/posts/"},{"@type":"ListItem","position":3,"name":"N5105 Promox VE 虚拟机频繁死机问题处理","item":"https://blog.hellowood.dev/posts/n5105-promox-ve-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%A2%91%E7%B9%81%E6%AD%BB%E6%9C%BA%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"N5105 Promox VE 虚拟机频繁死机问题处理","name":"N5105 Promox VE 虚拟机频繁死机问题处理","description":"N5105 Promox VE 虚拟机频繁死机问题处理 使用 N5105 作为 HomeLab 的服务器；之前安装的 ESXi，使用 Ubuntu 22 的时候经常会出现 Ubuntu CPU 占用达到100%，然后死机；但是其他的虚拟机都没有问题，因为对 Linux 并不熟，查看了 ESXi 和 Ubuntu 日志并没有异常；后面安装黑群晖一直失败，因此换到了 Proxmox VE\n换到 PVE 后依然存在同样的问题，以为是服务的问题，于是给 Docker 容器添加了资源限制，无效后迁移到了 CentOS 部署，发现还是同样的问题；并且越来越频繁，从一天一次变成了几小时一次，几乎无法使用\n猜测会不会是硬件问题，一番搜索发现在 N5105 上居然是个普遍的问题\n问题 这个问题于 2022-08-04 在 Proxmox 的问题反馈中提交：Bug 4188 - VMs freeze on Intel N5105 CPU，描述中\u0026quot;到运行Intel N5105 CPU的一些用户注意到在Proxmox上运行的虚拟机会冻结，并记录了各种错误。虚拟机会冻结，控制台无法输入，CPU利用率达到最大值，直到强制重启虚拟机\u0026quot;，现象和我遇到的是一样的，说明该现象是通病；\n2022-9-13 在帖子 Opt-in Linux 5.19 Kernel for Proxmox VE 7.x available 中，PVE员工宣布将 PVE 的内核升级到 5.19版本，在 Bug 反馈到讨论中有不少人确认有效\n这个问题在 2022-12-06 状态变更为 \u0026lsquo;FIX PACKAGED\u0026rsquo;；在 2022-12-14，PVE员工宣布支持将内核升级到 6.","keywords":["Proxmox VE","HomeLab"],"articleBody":"N5105 Promox VE 虚拟机频繁死机问题处理 使用 N5105 作为 HomeLab 的服务器；之前安装的 ESXi，使用 Ubuntu 22 的时候经常会出现 Ubuntu CPU 占用达到100%，然后死机；但是其他的虚拟机都没有问题，因为对 Linux 并不熟，查看了 ESXi 和 Ubuntu 日志并没有异常；后面安装黑群晖一直失败，因此换到了 Proxmox VE\n换到 PVE 后依然存在同样的问题，以为是服务的问题，于是给 Docker 容器添加了资源限制，无效后迁移到了 CentOS 部署，发现还是同样的问题；并且越来越频繁，从一天一次变成了几小时一次，几乎无法使用\n猜测会不会是硬件问题，一番搜索发现在 N5105 上居然是个普遍的问题\n问题 这个问题于 2022-08-04 在 Proxmox 的问题反馈中提交：Bug 4188 - VMs freeze on Intel N5105 CPU，描述中\"到运行Intel N5105 CPU的一些用户注意到在Proxmox上运行的虚拟机会冻结，并记录了各种错误。虚拟机会冻结，控制台无法输入，CPU利用率达到最大值，直到强制重启虚拟机\"，现象和我遇到的是一样的，说明该现象是通病；\n2022-9-13 在帖子 Opt-in Linux 5.19 Kernel for Proxmox VE 7.x available 中，PVE员工宣布将 PVE 的内核升级到 5.19版本，在 Bug 反馈到讨论中有不少人确认有效\n这个问题在 2022-12-06 状态变更为 ‘FIX PACKAGED’；在 2022-12-14，PVE员工宣布支持将内核升级到 6.1\n在 Bug 反馈的最后几条评论中，反馈死机的问题在升级 5.19 或 6.1 的内核后确实减少了，但是依然可能出现\n修复 按照 PVE 的回复，需要将 Linux 内核升级到 5.19 版本\n修改订阅源 关闭企业订阅源 该订阅源是付费版本的订阅源，提供例如集群管理、备份和恢复等功能，未购买时无法使用，因此需要将其移除；为了保险将文件重命名为 backup\nmv /etc/apt/sources.list.d/pve-enterprise.list /etc/apt/sources.list.d/pve-enterprise.list.backup 添加非订阅源 “pve-no-subscription” 是 Proxmox VE 软件包源名称中的一个参数，代表这个软件包源提供的是免费版本的 Proxmox VE 软件包， “bullseye” 是 Debian GNU/Linux 操作系统的一个版本号，是该操作系统的第11个主要发行版\necho 'deb http://download.proxmox.com/debian/pve bullseye pve-no-subscription' \u003e\u003e /etc/apt/sources.list.d/pve-no-subscription.list 添加 Debian non-free 源 添加 non-free 是为了更新 Microcode，默认的软件源不包含 non-free\ntee /etc/apt/sources.list.d/debian-non-free.list \u003e /dev/null \u003c","wordCount":"261","inLanguage":"en","datePublished":"2023-03-25T21:31:50+08:00","dateModified":"2023-03-25T21:31:50+08:00","author":{"@type":"Person","name":"HelloWood"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.hellowood.dev/posts/n5105-promox-ve-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%A2%91%E7%B9%81%E6%AD%BB%E6%9C%BA%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/"},"publisher":{"@type":"Organization","name":"HelloWood","logo":{"@type":"ImageObject","url":"https://blog.hellowood.dev/favicon.ico"}}}</script><link rel=icon href=/images/avatar.png sizes=16x16><link rel=apple-touch-icon href=/images/avatar.png><link rel=manifest href=/images/avatar.png><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.ff1bc260fafbfb440e10194d7d06d57eb5e85eed11d12d06255581262664204e.css integrity="sha256-/xvCYPr7+0QOEBlNfQbVfrXoXu0R0S0GJVWBJiZkIE4=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.af9899d47b21c333d192dccc82e0aa6650046e1a76ff4eaf89be703b64d94684.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","jtbhx98g62")</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand data-umami-event=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link data-umami-event=Blog href=/posts>Blog</a></li><li class="navigation-item navigation-menu"><a class=navigation-link data-umami-event=Tags href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link data-umami-event=Archive href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link data-umami-event=Dashboard href=https://umami.hellowood.dev/share/lab/Blog>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link data-umami-event=navigation-social href=https://github.com/helloworlde><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button data-umami-event=toggle-theme aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>N5105 Promox VE 虚拟机频繁死机问题处理</h1></header><p><small>March 25, 2023&nbsp;· 261 words&nbsp;· 2 min</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#问题>问题</a></li><li><a href=#修复>修复</a><ul><li><a href=#修改订阅源>修改订阅源</a></li><li><a href=#更新-519-版本的内核>更新 5.19 版本的内核</a></li><li><a href=#安装-intel-cpu-microcode>安装 Intel CPU microcode</a></li><li><a href=#重启>重启</a></li></ul></li></ul></nav></div><section class=blog-content><h1 id=n5105-promox-ve-虚拟机频繁死机问题处理>N5105 Promox VE 虚拟机频繁死机问题处理</h1><p>使用 N5105 作为 HomeLab 的服务器；之前安装的 ESXi，使用 Ubuntu 22 的时候经常会出现 Ubuntu CPU 占用达到100%，然后死机；但是其他的虚拟机都没有问题，因为对 Linux 并不熟，查看了 ESXi 和 Ubuntu 日志并没有异常；后面安装黑群晖一直失败，因此换到了 Proxmox VE</p><p>换到 PVE 后依然存在同样的问题，以为是服务的问题，于是给 Docker 容器添加了资源限制，无效后迁移到了 CentOS 部署，发现还是同样的问题；并且越来越频繁，从一天一次变成了几小时一次，几乎无法使用</p><p>猜测会不会是硬件问题，一番搜索发现在 N5105 上居然是个普遍的问题</p><h2 id=问题>问题</h2><p>这个问题于 2022-08-04 在 Proxmox 的问题反馈中提交：<a href="https://bugzilla.proxmox.com/show_bug.cgi?id=4188">Bug 4188 - VMs freeze on Intel N5105 CPU</a>，描述中"到运行Intel N5105 CPU的一些用户注意到在Proxmox上运行的虚拟机会冻结，并记录了各种错误。虚拟机会冻结，控制台无法输入，CPU利用率达到最大值，直到强制重启虚拟机"，现象和我遇到的是一样的，说明该现象是通病；</p><p><img src=https://img.hellowood.dev/picture/homelab-pve-vm-freeze-issue-bug-feedback.png alt=homelab-pve-vm-freeze-issue-bug-feedback.png></p><p>2022-9-13 在帖子 <a href=https://forum.proxmox.com/threads/opt-in-linux-5-19-kernel-for-proxmox-ve-7-x-available.115090/>Opt-in Linux 5.19 Kernel for Proxmox VE 7.x available</a> 中，PVE员工宣布将 PVE 的内核升级到 5.19版本，在 Bug 反馈到讨论中有不少人确认有效</p><p><img src=https://img.hellowood.dev/picture/homelab-pve-vm-freeze-issue-519-kenel.png alt=homelab-pve-vm-freeze-issue-519-kenel.png></p><p>这个问题在 2022-12-06 状态变更为 &lsquo;FIX PACKAGED&rsquo;；在 2022-12-14，PVE员工宣布支持将内核升级到 6.1</p><p><img src=https://img.hellowood.dev/picture/homelab-pve-vm-freeze-issue-61-kenel.png alt=homelab-pve-vm-freeze-issue-61-kenel.png></p><p>在 Bug 反馈的最后几条评论中，反馈死机的问题在升级 5.19 或 6.1 的内核后确实减少了，但是依然可能出现</p><p><img src=https://img.hellowood.dev/picture/homelab-pve-vm-freeze-issue-bug-comments2.png alt=homelab-pve-vm-freeze-issue-bug-comments2.png></p><h2 id=修复>修复</h2><p>按照 PVE 的回复，需要将 Linux 内核升级到 5.19 版本</p><h3 id=修改订阅源>修改订阅源</h3><ul><li>关闭企业订阅源</li></ul><p>该订阅源是付费版本的订阅源，提供例如集群管理、备份和恢复等功能，未购买时无法使用，因此需要将其移除；为了保险将文件重命名为 backup</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mv /etc/apt/sources.list.d/pve-enterprise.list /etc/apt/sources.list.d/pve-enterprise.list.backup
</span></span></code></pre></div><ul><li>添加非订阅源</li></ul><p>&ldquo;pve-no-subscription&rdquo; 是 Proxmox VE 软件包源名称中的一个参数，代表这个软件包源提供的是免费版本的 Proxmox VE 软件包， &ldquo;bullseye&rdquo; 是 Debian GNU/Linux 操作系统的一个版本号，是该操作系统的第11个主要发行版</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#39;deb http://download.proxmox.com/debian/pve bullseye pve-no-subscription&#39;</span> &gt;&gt; /etc/apt/sources.list.d/pve-no-subscription.list
</span></span></code></pre></div><ul><li>添加 Debian non-free 源</li></ul><p>添加 non-free 是为了更新 Microcode，默认的软件源不包含 non-free</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tee /etc/apt/sources.list.d/debian-non-free.list &gt; /dev/null <span style=color:#e6db74>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb http://deb.debian.org/debian bullseye main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb http://security.debian.org/debian-security bullseye-security main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb http://deb.debian.org/debian bullseye-updates main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div><p>在Debian操作系统中，软件包分为三个部分：main，contrib和non-free。其中，main 和 contrib 部分的软件都是自由软件，它们遵循自由软件定义（Free Software Definition），可以自由地使用、修改、复制和重新分发。</p><p>而 non-free 部分则包含了一些不符合自由软件定义的软件，例如某些专有硬件驱动程序、特定格式的音频和视频编码器等。这些软件可能有一些限制，例如不允许用户对其进行修改或重新分发。因此，这些软件在Debian社区中并不被认为是自由软件。</p><p><code>deb http://deb.debian.org/debian bullseye main contrib non-free</code> 这是Debian操作系统的主要软件源，其中包含了Debian操作系统的核心软件包和一些第三方软件包，其中contrib和non-free分别代表自由度不同的软件包。</p><p><code>deb http://security.debian.org/debian-security bullseye-security main contrib non-free</code> 这个源提供了Debian操作系统安全更新的软件包。这些软件包通常修复已知的漏洞和安全问题。</p><p><code>deb http://deb.debian.org/debian bullseye-updates main contrib non-free</code> 这个源提供了针对Debian操作系统稳定版本的非安全更新的软件包。这些软件包通常修复错误并提供新功能。</p><h3 id=更新-519-版本的内核>更新 5.19 版本的内核</h3><p>更新软件后安装 5.19 版本的内核</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt update -y
</span></span><span style=display:flex><span>apt install pve-kernel-5.19 -y
</span></span></code></pre></div><h3 id=安装-intel-cpu-microcode>安装 Intel CPU microcode</h3><p>处理器微码([Microcode] )。</p><p>intel-microcode 作用是为英特尔处理器提供微码（<a href=%28https://wiki.debian.org/Microcode%29>microcode</a>）更新。微码是一组指令，类似于处理器固件，可以在处理器上执行，以改变其行为或修复错误，内核能够在不需要通过BIOS更新的情况下更新处理器的固件。微码更新保存在易失性存储器中，因此BIOS/UEFI或内核会在每次启动时更新微码</p><p>intel-microcode 的更新通常由操作系统或设备厂商提供，旨在提高处理器的性能、稳定性和安全性。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt update -y
</span></span><span style=display:flex><span>apt install intel-microcode -y
</span></span></code></pre></div><h3 id=重启>重启</h3><p>等待更新完成后重启即可</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>reboot
</span></span></code></pre></div><p>重启后查看 Linux 内核版本，已经更新到了 <code>5.19.17-2-pve</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uname -r
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>5.19.17-2-pve
</span></span></code></pre></div><p>查看 Microcode 版本，可以看到更新到 <code>0x24000023</code> 版本，发布日期是 2022-02-19</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dmesg | grep microcode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>    0.000000<span style=color:#f92672>]</span> microcode: microcode updated early to revision 0x24000023, date <span style=color:#f92672>=</span> 2022-02-19
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>    0.203334<span style=color:#f92672>]</span> SRBDS: Vulnerable: No microcode
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>    1.337062<span style=color:#f92672>]</span> microcode: sig<span style=color:#f92672>=</span>0x906c0, pf<span style=color:#f92672>=</span>0x1, revision<span style=color:#f92672>=</span>0x24000023
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>    1.337093<span style=color:#f92672>]</span> microcode: Microcode Update Driver: v2.2.
</span></span></code></pre></div></section><div class=paginator><a class=prev href=https://blog.hellowood.dev/posts/proxmox-ve-%E6%B7%BB%E5%8A%A0%E7%9B%91%E6%8E%A7/><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>Proxmox VE 添加监控</span></a>
<a class=next href=https://blog.hellowood.dev/posts/openwrt-%E6%A1%A5%E6%8E%A5%E5%85%85%E5%BD%93%E4%BA%A4%E6%8D%A2%E6%9C%BA/><span>OpenWrt 桥接充当交换机</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div><div class=related-resources><h3>Related Resources</h3><nav><ul><li><a href=/posts/proxmox-ve-%E6%B7%BB%E5%8A%A0%E7%9B%91%E6%8E%A7/>Proxmox VE 添加监控</a></li><li><a href=/posts/openwrt-%E5%9C%A8-pve-%E4%B8%AD%E4%BB%A5%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%96%B9%E5%BC%8F%E5%AE%89%E8%A3%85/>OpenWrt 在 PVE 中以虚拟机方式安装</a></li><li><a href=/posts/proxmox-ve-%E5%AE%89%E8%A3%85%E5%88%9D%E5%A7%8B%E5%8C%96/>Proxmox VE 安装初始化</a></li></ul></nav></div></article></div><footer class=footer><p>&copy; 2024 <a href=https://blog.hellowood.dev>HelloWood</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank data-umami-event=to-hugo>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank data-umami-event=to-ladder>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g data-umami-event=top-link><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>