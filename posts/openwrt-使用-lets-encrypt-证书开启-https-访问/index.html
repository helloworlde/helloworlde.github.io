<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>OpenWrt 使用 Lets Encrypt 证书开启 HTTPS 访问</title><meta charset=utf-8><meta name=description content="Ladder@OpenWrt 使用 Let&rsquo;s Encrypt 证书开启 HTTPS 访问 OpenWrt 支持开启 HTTPS 访问，但是自签发的证书无法通过 Chrome 等浏览器的认证；因此需要使用 Let&rsquo;s Encrypt 申请证书；通过 uHTTPd 应用配置证书，使用 DNS 验证的方式申请证书
配置 HTTPS 访问需要使用到公网 IP 和域名，需要确认已经可以通过公网访问，并且可以修改域名的解析
安装 uHTTPd uHTTPd 用于 OpenWrt 配置 Web 服务，如端口，证书等
opkg update opkg install luci-app-uhttpd luci-i18n-uhttpd-zh-cn 安装完成后即可在服务-uHTTPd 页面查看端口和证书配置
安装配置 ACME ACME 是 Let&rsquo;s Encrypt 官方支持的客户端；OpenWrt 支持使用 ACME 申请证书，在 ACME 应用中添加证书相关配置即可
安装 ACME opkg update opkg install acme luci-app-acme luci-i18n-acme-zh-cn acme-dnsapi 安装完成后可以在服务-ACME 证书中进行配置
配置 ACME 配置账户信息 首先需要为 ACME 配置邮箱，用于接受证书过期等信息；在 ACME 全局配置-电子邮件帐户添加即可"><meta name=author content="HelloWood"><link rel=canonical href=https://blog.hellowood.dev/posts/openwrt-%E4%BD%BF%E7%94%A8-lets-encrypt-%E8%AF%81%E4%B9%A6%E5%BC%80%E5%90%AF-https-%E8%AE%BF%E9%97%AE/><meta name=google-site-verification content="G-3MSGPYTHPZ"><link rel=alternate type=application/rss+xml href=https://blog.hellowood.dev/index.xml title=HelloWood><script async src="https://www.googletagmanager.com/gtag/js?id=G-3MSGPYTHPZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3MSGPYTHPZ",{anonymize_ip:!1})}</script><script async defer data-website-id=7a9034de-0ce7-4756-942a-829e6cd22301 src=https://umami.hellowood.dev/script.js></script><meta property="og:title" content="OpenWrt 使用 Lets Encrypt 证书开启 HTTPS 访问"><meta property="og:description" content="OpenWrt 使用 Let&rsquo;s Encrypt 证书开启 HTTPS 访问 OpenWrt 支持开启 HTTPS 访问，但是自签发的证书无法通过 Chrome 等浏览器的认证；因此需要使用 Let&rsquo;s Encrypt 申请证书；通过 uHTTPd 应用配置证书，使用 DNS 验证的方式申请证书
配置 HTTPS 访问需要使用到公网 IP 和域名，需要确认已经可以通过公网访问，并且可以修改域名的解析
安装 uHTTPd uHTTPd 用于 OpenWrt 配置 Web 服务，如端口，证书等
opkg update opkg install luci-app-uhttpd luci-i18n-uhttpd-zh-cn 安装完成后即可在服务-uHTTPd 页面查看端口和证书配置
安装配置 ACME ACME 是 Let&rsquo;s Encrypt 官方支持的客户端；OpenWrt 支持使用 ACME 申请证书，在 ACME 应用中添加证书相关配置即可
安装 ACME opkg update opkg install acme luci-app-acme luci-i18n-acme-zh-cn acme-dnsapi 安装完成后可以在服务-ACME 证书中进行配置
配置 ACME 配置账户信息 首先需要为 ACME 配置邮箱，用于接受证书过期等信息；在 ACME 全局配置-电子邮件帐户添加即可"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.hellowood.dev/posts/openwrt-%E4%BD%BF%E7%94%A8-lets-encrypt-%E8%AF%81%E4%B9%A6%E5%BC%80%E5%90%AF-https-%E8%AE%BF%E9%97%AE/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-11T21:57:52+08:00"><meta property="article:modified_time" content="2022-11-11T21:57:52+08:00"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/openwrt-%E6%A1%A5%E6%8E%A5%E5%85%85%E5%BD%93%E4%BA%A4%E6%8D%A2%E6%9C%BA/"><meta property="og:see_also" content="https://blog.hellowood.dev/posts/openwrt-%E5%9C%A8-pve-%E4%B8%AD%E4%BB%A5%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%96%B9%E5%BC%8F%E5%AE%89%E8%A3%85/"><meta name=twitter:card content="summary"><meta name=twitter:title content="OpenWrt 使用 Lets Encrypt 证书开启 HTTPS 访问"><meta name=twitter:description content="OpenWrt 使用 Let&rsquo;s Encrypt 证书开启 HTTPS 访问 OpenWrt 支持开启 HTTPS 访问，但是自签发的证书无法通过 Chrome 等浏览器的认证；因此需要使用 Let&rsquo;s Encrypt 申请证书；通过 uHTTPd 应用配置证书，使用 DNS 验证的方式申请证书
配置 HTTPS 访问需要使用到公网 IP 和域名，需要确认已经可以通过公网访问，并且可以修改域名的解析
安装 uHTTPd uHTTPd 用于 OpenWrt 配置 Web 服务，如端口，证书等
opkg update opkg install luci-app-uhttpd luci-i18n-uhttpd-zh-cn 安装完成后即可在服务-uHTTPd 页面查看端口和证书配置
安装配置 ACME ACME 是 Let&rsquo;s Encrypt 官方支持的客户端；OpenWrt 支持使用 ACME 申请证书，在 ACME 应用中添加证书相关配置即可
安装 ACME opkg update opkg install acme luci-app-acme luci-i18n-acme-zh-cn acme-dnsapi 安装完成后可以在服务-ACME 证书中进行配置
配置 ACME 配置账户信息 首先需要为 ACME 配置邮箱，用于接受证书过期等信息；在 ACME 全局配置-电子邮件帐户添加即可"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://blog.hellowood.dev/posts/"},{"@type":"ListItem","position":3,"name":"OpenWrt 使用 Lets Encrypt 证书开启 HTTPS 访问","item":"https://blog.hellowood.dev/posts/openwrt-%E4%BD%BF%E7%94%A8-lets-encrypt-%E8%AF%81%E4%B9%A6%E5%BC%80%E5%90%AF-https-%E8%AE%BF%E9%97%AE/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"OpenWrt 使用 Lets Encrypt 证书开启 HTTPS 访问","name":"OpenWrt 使用 Lets Encrypt 证书开启 HTTPS 访问","description":"OpenWrt 使用 Let\u0026rsquo;s Encrypt 证书开启 HTTPS 访问 OpenWrt 支持开启 HTTPS 访问，但是自签发的证书无法通过 Chrome 等浏览器的认证；因此需要使用 Let\u0026rsquo;s Encrypt 申请证书；通过 uHTTPd 应用配置证书，使用 DNS 验证的方式申请证书\n配置 HTTPS 访问需要使用到公网 IP 和域名，需要确认已经可以通过公网访问，并且可以修改域名的解析\n安装 uHTTPd uHTTPd 用于 OpenWrt 配置 Web 服务，如端口，证书等\nopkg update opkg install luci-app-uhttpd luci-i18n-uhttpd-zh-cn 安装完成后即可在服务-uHTTPd 页面查看端口和证书配置\n安装配置 ACME ACME 是 Let\u0026rsquo;s Encrypt 官方支持的客户端；OpenWrt 支持使用 ACME 申请证书，在 ACME 应用中添加证书相关配置即可\n安装 ACME opkg update opkg install acme luci-app-acme luci-i18n-acme-zh-cn acme-dnsapi 安装完成后可以在服务-ACME 证书中进行配置\n配置 ACME 配置账户信息 首先需要为 ACME 配置邮箱，用于接受证书过期等信息；在 ACME 全局配置-电子邮件帐户添加即可","keywords":["OpenWrt","HomeLab"],"articleBody":"OpenWrt 使用 Let’s Encrypt 证书开启 HTTPS 访问 OpenWrt 支持开启 HTTPS 访问，但是自签发的证书无法通过 Chrome 等浏览器的认证；因此需要使用 Let’s Encrypt 申请证书；通过 uHTTPd 应用配置证书，使用 DNS 验证的方式申请证书\n配置 HTTPS 访问需要使用到公网 IP 和域名，需要确认已经可以通过公网访问，并且可以修改域名的解析\n安装 uHTTPd uHTTPd 用于 OpenWrt 配置 Web 服务，如端口，证书等\nopkg update opkg install luci-app-uhttpd luci-i18n-uhttpd-zh-cn 安装完成后即可在服务-uHTTPd 页面查看端口和证书配置\n安装配置 ACME ACME 是 Let’s Encrypt 官方支持的客户端；OpenWrt 支持使用 ACME 申请证书，在 ACME 应用中添加证书相关配置即可\n安装 ACME opkg update opkg install acme luci-app-acme luci-i18n-acme-zh-cn acme-dnsapi 安装完成后可以在服务-ACME 证书中进行配置\n配置 ACME 配置账户信息 首先需要为 ACME 配置邮箱，用于接受证书过期等信息；在 ACME 全局配置-电子邮件帐户添加即可\n配置证书 常规设置 在证书配置中，添加一个新的配置；这里使用阿里云作为 DNS 解析；\n首先启用配置，并添加要配置的域名，支持特定域名或者通配的域名；\n建议第一次使用时勾选使用临时服务器，测试通过后再申请正式的证书；同时选中用于 uhttpd，这样 ACME 会直接修改 uHTTPd 的证书为生成的证书\n质询验证 因为域名没有指向运行中的服务，所以选择验证方式为 DNS，在验证时会添加 DNS 解析的方式进行验证；\nDNS API 为域名解析商，具体的值可以在 https://github.com/acmesh-official/acme.sh/wiki/dnsapi 查找，如阿里云的值为 dns_ali\nDNS API 凭证为域名解析商的验证凭据信息，具体的值可以在 https://github.com/acmesh-official/acme.sh/wiki/dnsapi 查找；如阿里云使用 AK/SK，对应的名称为 Ali_Key 和 Ali_Secret 然后选择保存并应用，ACME 会在后台运行，申请证书；申请结果将会在 /etc/acme路径下；如果申请成功，后出现域名对应的文件夹，包含需要的证书文件；如果申请失败，会出现域名-failed格式的文件夹\nls -alh /etc/acme/ drwxr-xr-x 2 root root 4.0K Nov 1 19:53 *.homelab.dev drwxr-xr-x 4 root root 4.0K Nov 7 12:46 . drwxr-xr-x 1 root root 4.0K Oct 15 20:32 .. -rw-r--r-- 1 root root 179 Nov 1 19:53 account.conf drwxr-xr-x 4 root root 4.0K Nov 1 19:43 ca -rw-r--r-- 1 root root 230 Nov 7 00:00 http.header -rw-r--r-- 1 root root 0 Nov 2 10:40 wget-log ls -alh /etc/acme/*.homelab.dev/ -rw-r--r-- 1 root root 1.8K Nov 1 19:53 *.homelab.dev.cer -rw-r--r-- 1 root root 631 Nov 1 19:53 *.homelab.dev.conf -rw-r--r-- 1 root root 980 Nov 1 19:53 *.homelab.dev.csr -rw-r--r-- 1 root root 158 Nov 1 19:53 *.homelab.csr.conf -rw-r--r-- 1 root root 1.6K Nov 1 19:53 *.homelab.dev.key drwxr-xr-x 2 root root 4.0K Nov 1 19:53 . drwxr-xr-x 4 root root 4.0K Nov 7 12:46 .. -rw-r--r-- 1 root root 3.7K Nov 1 19:53 ca.cer -rw-r--r-- 1 root root 5.5K Nov 1 19:53 fullchain.cer 访问服务-uHTTPd，发现证书已经被替换为 ACME申请的证书：\n如果没有自动替换，可以手动选择对应的证书路径，或者修改 /ect/config/uhttpd 配置文件指定\nconfig uhttpd 'main' list listen_https '0.0.0.0:443' list listen_https '[::]:443' // ... option key '/etc/acme/*.homelab.dev/*.homelab.dev.key' option cert '/etc/acme/*.homelab.dev/fullchain.cer' 这样，就可以在外网通过\n","wordCount":"281","inLanguage":"en","datePublished":"2022-11-11T21:57:52+08:00","dateModified":"2022-11-11T21:57:52+08:00","author":{"@type":"Person","name":"HelloWood"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.hellowood.dev/posts/openwrt-%E4%BD%BF%E7%94%A8-lets-encrypt-%E8%AF%81%E4%B9%A6%E5%BC%80%E5%90%AF-https-%E8%AE%BF%E9%97%AE/"},"publisher":{"@type":"Organization","name":"HelloWood","logo":{"@type":"ImageObject","url":"https://blog.hellowood.dev/favicon.ico"}}}</script><link rel=icon href=/images/avatar.png sizes=16x16><link rel=apple-touch-icon href=/images/avatar.png><link rel=manifest href=/images/avatar.png><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css><link rel=stylesheet href=/css/main.min.f8020eba33d585b82c30b2a1ceb0d4c4e8e41fb6d8843d07d8ad056da8712972.css integrity="sha256-+AIOujPVhbgsMLKhzrDUxOjkH7bYhD0H2K0FbahxKXI=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.872dfd2cd00064018a833a6e8e77a0fbf8fbac159546f2f205d4dad79a5d8e15.js></script>
<script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/posts>Blog</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://umami.hellowood.dev/share/lab/Blog>Dashboard</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/helloworlde><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>OpenWrt 使用 Lets Encrypt 证书开启 HTTPS 访问</h1></header><p><small>November 11, 2022&nbsp;· 281 words&nbsp;· 2 min</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#安装-uhttpd>安装 uHTTPd</a></li><li><a href=#安装配置-acme>安装配置 ACME</a><ul><li><a href=#安装-acme>安装 ACME</a></li><li><a href=#配置-acme>配置 ACME</a></li></ul></li></ul></nav></div><section class=blog-content><h1 id=openwrt-使用-lets-encrypt-证书开启-https-访问>OpenWrt 使用 Let&rsquo;s Encrypt 证书开启 HTTPS 访问</h1><p>OpenWrt 支持开启 HTTPS 访问，但是自签发的证书无法通过 Chrome 等浏览器的认证；因此需要使用 Let&rsquo;s Encrypt 申请证书；通过 uHTTPd 应用配置证书，使用 DNS 验证的方式申请证书</p><p>配置 HTTPS 访问需要使用到公网 IP 和域名，需要确认已经可以通过公网访问，并且可以修改域名的解析</p><h2 id=安装-uhttpd>安装 uHTTPd</h2><p>uHTTPd 用于 OpenWrt 配置 Web 服务，如端口，证书等</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>opkg update
</span></span><span style=display:flex><span>opkg install luci-app-uhttpd luci-i18n-uhttpd-zh-cn
</span></span></code></pre></div><p>安装完成后即可在服务-uHTTPd 页面查看端口和证书配置</p><h2 id=安装配置-acme>安装配置 ACME</h2><p><a href=https://letsencrypt.org/zh-cn/docs/client-options/>ACME</a> 是 Let&rsquo;s Encrypt 官方支持的客户端；OpenWrt 支持使用 ACME 申请证书，在 ACME 应用中添加证书相关配置即可</p><h3 id=安装-acme>安装 ACME</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>opkg update
</span></span><span style=display:flex><span>opkg install acme luci-app-acme luci-i18n-acme-zh-cn acme-dnsapi
</span></span></code></pre></div><p>安装完成后可以在服务-ACME 证书中进行配置</p><h3 id=配置-acme>配置 ACME</h3><h4 id=配置账户信息>配置账户信息</h4><p>首先需要为 ACME 配置邮箱，用于接受证书过期等信息；在 ACME 全局配置-电子邮件帐户添加即可</p><p><img src=https://hellowoodes.oss-cn-beijing.aliyuncs.com/picture/homelab-openwrt-acme-email-config.png alt=homelab-openwrt-acme-email-config.png></p><h4 id=配置证书>配置证书</h4><ul><li>常规设置</li></ul><p>在证书配置中，添加一个新的配置；这里使用阿里云作为 DNS 解析；</p><p>首先启用配置，并添加要配置的域名，支持特定域名或者通配的域名；</p><p>建议第一次使用时勾选使用临时服务器，测试通过后再申请正式的证书；同时选中用于 uhttpd，这样 ACME 会直接修改 uHTTPd 的证书为生成的证书</p><p><img src=https://hellowoodes.oss-cn-beijing.aliyuncs.com/picture/homelab-openwrt-acme-regular-config.png alt=homelab-openwrt-acme-regular-config.png></p><ul><li>质询验证</li></ul><p>因为域名没有指向运行中的服务，所以选择验证方式为 DNS，在验证时会添加 DNS 解析的方式进行验证；</p><p>DNS API 为域名解析商，具体的值可以在 <a href=https://github.com/acmesh-official/acme.sh/wiki/dnsapi>https://github.com/acmesh-official/acme.sh/wiki/dnsapi</a> 查找，如阿里云的值为 <code>dns_ali</code></p><p>DNS API 凭证为域名解析商的验证凭据信息，具体的值可以在 <a href=https://github.com/acmesh-official/acme.sh/wiki/dnsapi>https://github.com/acmesh-official/acme.sh/wiki/dnsapi</a> 查找；如阿里云使用 AK/SK，对应的名称为 <code>Ali_Key</code> 和 <code>Ali_Secret</code>
<img src=https://hellowoodes.oss-cn-beijing.aliyuncs.com/picture/homelab-openwrt-acme-auth-config.png alt=homelab-openwrt-acme-auth-config.png></p><p>然后选择保存并应用，ACME 会在后台运行，申请证书；申请结果将会在 <code>/etc/acme</code>路径下；如果申请成功，后出现域名对应的文件夹，包含需要的证书文件；如果申请失败，会出现<code>域名-failed</code>格式的文件夹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls -alh /etc/acme/
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>2</span> root     root        4.0K Nov  <span style=color:#ae81ff>1</span> 19:53 *.homelab.dev
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>4</span> root     root        4.0K Nov  <span style=color:#ae81ff>7</span> 12:46 .
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>1</span> root     root        4.0K Oct <span style=color:#ae81ff>15</span> 20:32 ..
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root         <span style=color:#ae81ff>179</span> Nov  <span style=color:#ae81ff>1</span> 19:53 account.conf
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>4</span> root     root        4.0K Nov  <span style=color:#ae81ff>1</span> 19:43 ca
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root         <span style=color:#ae81ff>230</span> Nov  <span style=color:#ae81ff>7</span> 00:00 http.header
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root           <span style=color:#ae81ff>0</span> Nov  <span style=color:#ae81ff>2</span> 10:40 wget-log
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ls -alh /etc/acme/*.homelab.dev/
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root        1.8K Nov  <span style=color:#ae81ff>1</span> 19:53 *.homelab.dev.cer
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root         <span style=color:#ae81ff>631</span> Nov  <span style=color:#ae81ff>1</span> 19:53 *.homelab.dev.conf
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root         <span style=color:#ae81ff>980</span> Nov  <span style=color:#ae81ff>1</span> 19:53 *.homelab.dev.csr
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root         <span style=color:#ae81ff>158</span> Nov  <span style=color:#ae81ff>1</span> 19:53 *.homelab.csr.conf
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root        1.6K Nov  <span style=color:#ae81ff>1</span> 19:53 *.homelab.dev.key
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>2</span> root     root        4.0K Nov  <span style=color:#ae81ff>1</span> 19:53 .
</span></span><span style=display:flex><span>drwxr-xr-x    <span style=color:#ae81ff>4</span> root     root        4.0K Nov  <span style=color:#ae81ff>7</span> 12:46 ..
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root        3.7K Nov  <span style=color:#ae81ff>1</span> 19:53 ca.cer
</span></span><span style=display:flex><span>-rw-r--r--    <span style=color:#ae81ff>1</span> root     root        5.5K Nov  <span style=color:#ae81ff>1</span> 19:53 fullchain.cer
</span></span></code></pre></div><p>访问服务-uHTTPd，发现证书已经被替换为 ACME申请的证书：</p><p><img src=https://hellowoodes.oss-cn-beijing.aliyuncs.com/picture/homelab-openwrt-acme-uhttpd-config.png alt=homelab-openwrt-acme-uhttpd-config.png></p><p>如果没有自动替换，可以手动选择对应的证书路径，或者修改 <code>/ect/config/uhttpd</code> 配置文件指定</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>config uhttpd <span style=color:#e6db74>&#39;main&#39;</span>
</span></span><span style=display:flex><span>	list listen_https <span style=color:#e6db74>&#39;0.0.0.0:443&#39;</span>
</span></span><span style=display:flex><span>	list listen_https <span style=color:#e6db74>&#39;[::]:443&#39;</span>
</span></span><span style=display:flex><span>	// ...
</span></span><span style=display:flex><span>	option key <span style=color:#e6db74>&#39;/etc/acme/*.homelab.dev/*.homelab.dev.key&#39;</span>
</span></span><span style=display:flex><span>	option cert <span style=color:#e6db74>&#39;/etc/acme/*.homelab.dev/fullchain.cer&#39;</span>
</span></span></code></pre></div><p>这样，就可以在外网通过</p></section><div class=paginator><a class=prev href=https://blog.hellowood.dev/posts/homeassistant-%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E6%90%AD%E5%BB%BA%E4%B8%8E%E4%BD%BF%E7%94%A8/><span>&larr;&nbsp;&nbsp;</span><span>HomeAssistant 基于容器搭建与使用</span></a>
<a class=next href=https://blog.hellowood.dev/posts/clash-%E4%BD%BF%E7%94%A8-docker-%E9%83%A8%E7%BD%B2/><span>Clash 使用 Docker 部署</span><span>&nbsp;&nbsp;&rarr;</span></a></div><div class=related-resources><h3>Related Resources</h3><nav><ul><li><a href=/posts/openwrt-%E6%A1%A5%E6%8E%A5%E5%85%85%E5%BD%93%E4%BA%A4%E6%8D%A2%E6%9C%BA/>OpenWrt 桥接充当交换机</a></li><li><a href=/posts/openwrt-%E5%9C%A8-pve-%E4%B8%AD%E4%BB%A5%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%96%B9%E5%BC%8F%E5%AE%89%E8%A3%85/>OpenWrt 在 PVE 中以虚拟机方式安装</a></li></ul></nav></div></article></div><footer class=footer><p>&copy; 2023 <a href=https://blog.hellowood.dev>HelloWood</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg></a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>